{"version":3,"sources":["layouts/MonitoringWorkout/styles.module.scss","layouts/PrepareWorkout/styles.module.scss","layouts/FinishedWorkout/styles.module.scss","layouts/AdminDashboard/styles.module.scss","layouts/UserList/styles.module.scss","layouts/DifficulityList/styles.module.scss","layouts/RecordList/styles.module.scss","layouts/SignIn/styles.module.scss","components/Header/styles.module.scss","layouts/Missing/styles.module.scss","layouts/Unauthorized/styles.module.scss","store/actions.js","constants/path.js","constants/roles.js","constants/warn.js","store/index.js","routes/ProtectedRoutes.js","services/firebase.js","layouts/SignIn/index.js","layouts/AdminDashboard/index.js","assets/images/right-arrow.png","components/Header/index.js","layouts/Missing/index.js","layouts/Unauthorized/index.js","util/helper.js","util/wait.js","layouts/PrepareWorkout/index.js","assets/sounds/warn-slight.wav","assets/sounds/warn-medium.wav","assets/sounds/warn-high.wav","assets/sounds/notification.wav","assets/sounds/goal-archieved.wav","util/useAudio.js","util/formatSeconds.js","util/configLineChart.js","components/StopWatch/index.js","layouts/MonitoringWorkout/index.js","layouts/UserList/index.js","layouts/DifficulityList/index.js","layouts/FinishedWorkout/index.js","layouts/RecordList/index.js","routes/index.js","layouts/App/index.js","index.js"],"names":["module","exports","SET_AUTH","ROUTE_PATH","home","sign_in","unauthorized","admin_dashbaord","prepare_workout","monitoring_workout","user_list","difficulty_list","record_list","finsished_workout","ROLES","WARN","WARN_THRESHOLD","StoreContext","createContext","initialState","auth","isValid","roles","Editor","reducer","state","action","type","payload","StoreProvider","children","useReducer","value","dispatch","Provider","useStore","useContext","ProtectedRoutes","allowedRoles","find","role","includes","replace","to","app","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","db","getFirestore","getAuth","usersRef","collection","recordsRef","difficultiesRef","validateInputPairId","pairId","a","q","query","where","getDocs","querySnapshot","empty","size","forEach","doc","record","data","recordId","id","finishedWorkoutTime","generateValidPairId","pass","test","getRandomPairId","isPairIdValid","Math","floor","random","toString","Content","Layout","Title","Typography","formLayout","labelCol","span","wrapperCol","tailLayout","offset","SignIn","navigate","useNavigate","Form","useForm","form","useState","loading","setLoading","login","validateFields","values","console","log","signInWithEmailAndPassword","email","password","userCredential","user","Admin","goDashboard","message","error","className","style","padding","styles","container","layout","autoComplete","Item","label","colon","marginBottom","level","name","rules","required","placeholder","Password","htmlType","onClick","TileWithIconAndAction","icon","tile","addOn","backgroundImage","tileIcon","tileLabel","AdminDashboard","TeamOutlined","SlidersOutlined","ProfileOutlined","RocketOutlined","Header","Missing","Unauthorized","helper","object","defaults","_","list","iteratee","context","Set","Array","from","index","array","call","each","map","obj","mapObject","memo","reduce","every","some","predicate","result","Map","entries","entry","key","findIndex","filter","this","length","max","min","any","isArray","n","isEmpty","first","last","has","b","File","i","JSON","stringify","isNullOrUndefined","isString","isPrimitive","Object","isBoolean","isNumber","isFunction","isDate","isNull","isUndefined","undefined","isExisted","isNotExisted","isObject","Number","isInteger","isFinite","isNaN","isFile","json","parse","e","proto","getPrototypeOf","prototype","React","isValidElement","wait","ms","Promise","resolve","setTimeout","Countdown","Statistic","Option","Select","Text","initialPacket","rpm","time","heartRate","unsubscribe","WarnHRValueDisplay","warn","phase","overVal","display","fontSize","PrepareWorkout","users","setUsers","difficulties","setDifficulties","isDone","setIsDone","selectedUser","setSelectedUser","selectedDiff","setSelectedDiff","selectedUserData","setSelectedUserData","selectedDiffData","setSelectedDiffData","userModalVis","setUserModalVis","diffModalVis","setDiffModalVis","warnHRValues","setWarnHRValues","isPairing","setIsPairing","targetgetRecordId","setTargetRecordId","setPairId","isAppConnected","setIsAppConnected","pairDeadline","setPairDeadline","inputPairId","setInputPairId","useEffect","init","fetchUsers","fetchDiffs","targetRecordRef","onSnapshot","currData","updateDoc","success","push","Modal","confirm","title","ExclamationCircleOutlined","content","onOk","deleteRecord","confirmUserAndDiff","valid","createRecord","theDiff","d","targetHeartRate","upperLimitHeartRate","difficulty","createdTime","Timestamp","now","addDoc","beginWorkoutTime","deadline","Date","info","leave","deleteDoc","pairWithApp","theRecordId","alert","onDeadlineExpired","resetFields","getExactThresholdValue","calBase","overHigh","ceil","overMedium","simulateAppCotent","pairing","Search","allowClear","onChange","target","onSearch","disabled","PageHeader","subTitle","onBack","marginTop","gutter","u","diff","targetWorkoutTime","visible","onCancel","footer","bordered","descriptions","age","note","width","column","color","text","alignItems","dashed","minWidth","borderWidth","margin","marginRight","placement","trigger","SettingOutlined","pairIdWrapper","split","c","onFinish","indicator","LoadingOutlined","spin","ArrowRightOutlined","OTHER_SOUND","Notification","Archieved","useAudio","Audio","other_notification_url","audioPlayer","getAudioPermission","play","playWarnSound","src","warn_slight_url","warn_medium_url","warn_high_url","playOtherSound","sound","other_archieved_url","formatSeconds","input","sec_num","parseInt","hours","minutes","seconds","formatted","configLineChart","xField","yField","yAxis","legend","itemName","formatter","item","meta","alias","geometryOptions","geometry","lineStyle","lineWidth","lineDash","smooth","opacity","point","shape","stroke","fill","annotations","start","end","offsetY","position","textAlign","tooltip","showTitle","StopWatch","initialValue","setTime","miliDisplay","setMiliDisplay","interval","displayInterval","setInterval","clearInterval","slice","unsubscribeRecord","unsubscribePackets","MonitoringWorkout","params","useParams","setRecord","setUser","setDifficulty","packets","setPackets","isInitRecordDone","setIsInitRecordDone","isInitPacketsDone","setIsInitPacketsDone","beginStopWatch","setBeginStopWatch","nextHeartRateVal","setNextHeartRateVal","grantAudioPerssion","begin","isNotEmpty","evaluateCurrPacket","checkIntegrity","listenRecordChange","listenPacketsChange","maskClosable","recordRef","getDoc","recordSnapshot","recordData","userRef","userSnapshot","difficultyRef","diffSnapshot","toDate","packetsRef","newPackets","timeLabel","formatWithMoment","sort","splice","packet","overSlight","sendNotification","addRpmAndHeartRate","nextPacket","goFinishWorkout","notification","description","open","SmileOutlined","popoverContent","enterButton","glass","col","col1","col2","stopWatchWrapper","moment","duration","asMilliseconds","getStopWatchInitialValue","format","col3","mainCol","columns","openViewModal","openEditModal","onDeleteUser","dataIndex","sorter","compare","align","render","direction","danger","MoreOutlined","rotate","modalFormLayout","UserList","filteredUser","setFilteredUser","searchBarRef","useRef","currUser","setCurrUser","searchForm","editForm","createForm","createModalVisible","setCreateModalVisible","viewModalVisible","setViewModalVisible","editModalVisible","setEditModalVisible","current","blur","onCreateUser","isDeleted","closeAllModals","onPatchUser","currUserRef","deleteUser","theUserRef","extra","PlusOutlined","clearIcon","CloseCircleFilled","ref","SearchOutlined","setFieldsValue","theUser","okText","okType","cancelText","dataSource","pagination","pageSize","marginLeft","confirmLoading","destroyOnClose","addonAfter","TextArea","showCount","maxLength","autoSize","minRows","maxRows","onDeleteDiff","DifficulityList","filteredDiffs","setFilteredDiffs","currDiff","setCurrDiff","createFormChange","setCreateFormChange","editFormChange","setEditFormChange","onCreateDiff","onPatchDiff","deleteDiff","theDiffRef","onFormValueChange","changedVal","allVal","formKey","onValuesChange","FinishedWorkout","therapist","setTherapist","comment","setComment","inputStatus","setInputStatus","onFormSubmit","preventDefault","updateTherapistInfo","h","m","s","returnStr","calWorkoutTime","toLocaleString","prefix","UserOutlined","status","userData","difficultyData","currRecord","RecordList","records","setReocrds","filteredRecords","setFilteredReocrds","setCurrRecord","currReocrdPackets","setCurrRecordPackets","fetchRecords","patchRecordsWithUserAndDiff","getTime","patchedRecords","userId","r","AppRoutes","path","element","AppProvider","initializedDone","setInitializedDone","attempLogin","window","addEventListener","beforeunloadListener","visibilitychangeListener","removeEventListener","document","visibilityState","locale","ReactDOM","StrictMode","App","getElementById"],"mappings":"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","file":"static/js/main.b882260e.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__2O6lW\",\"glass\":\"styles_glass__3MZ6q\",\"col\":\"styles_col__3dx1b\",\"mainCol\":\"styles_mainCol__2K9mE\",\"col1\":\"styles_col1__1e9Hq\",\"col2\":\"styles_col2__2sM5V\",\"col3\":\"styles_col3__ZFdLr\",\"stopWatchWrapper\":\"styles_stopWatchWrapper__YtDaA\",\"difficulty\":\"styles_difficulty__27-NT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__3NK8e\",\"pairIdWrapper\":\"styles_pairIdWrapper__RnU7L\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__msRCF\",\"pageHeader\":\"styles_pageHeader__242Ry\",\"descriptions\":\"styles_descriptions__aLChC\",\"form\":\"styles_form__3ok_y\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__3-pv1\",\"tile\":\"styles_tile__ld1d9\",\"addOn\":\"styles_addOn__lAcI5\",\"tileIcon\":\"styles_tileIcon__3Rzsu\",\"tileLabel\":\"styles_tileLabel__21knx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__3BM2M\",\"descriptions\":\"styles_descriptions__2Jtwo\",\"form\":\"styles_form__a3cRe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__2hB-r\",\"descriptions\":\"styles_descriptions__1kY2t\",\"form\":\"styles_form__1Qnic\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__3HuKR\",\"descriptions\":\"styles_descriptions__3UP8P\",\"form\":\"styles_form__1qrcZ\",\"pageHeader\":\"styles_pageHeader__3-ZV-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__2s08f\",\"scroll\":\"styles_scroll__2lbTr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__103ut\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__Hfgws\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__333xu\"};","export const SET_AUTH = 'SET_AUTH';\n","const ROUTE_PATH = {\n    home: '/',\n    sign_in: '/sign-in',\n    unauthorized: '/unauthorized',\n    admin_dashbaord: '/dashboard',\n    prepare_workout: '/prepare-workout',\n    monitoring_workout: '/monitoring-workout',\n    user_list: '/user-list',\n    difficulty_list: '/difficulty-list',\n    record_list: '/record-list',\n    finsished_workout: '/finished-workout',\n};\n\nexport default ROUTE_PATH;\n","const ROLES = {\n    'User': 2001,\n    'Editor': 1984,\n    'Admin': 5150,\n};\n\nexport default ROLES;\n","const WARN = {\n    Slight: 'slight',\n    Medium: 'medium',\n    High: 'high',\n};\n\nconst WARN_THRESHOLD = {\n    Slight: 105,\n    Medium: 115,\n    High: 120,\n};\n\nexport { WARN, WARN_THRESHOLD };\n","import { createContext, useReducer, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { SET_AUTH } from './actions';\n\nimport { ROLES } from '../constants';\n\nconst StoreContext = createContext();\n\nconst initialState = {\n    auth: {\n        isValid: true,\n        roles: [ROLES.Editor], // 1984: Editor ; 5150: Admin\n    },\n};\n\nconst reducer = (state, action) => {\n    switch (action.type) {\n        case SET_AUTH:\n            return {\n                ...state,\n                auth: {\n                    ...action.payload,\n                },\n            };\n        default:\n            return state;\n    }\n};\n\nconst StoreProvider = ({ children }) => {\n    const [state, dispatch] = useReducer(reducer, initialState);\n    const value = { state, dispatch };\n\n    return (\n        <StoreContext.Provider value={value}>{children}</StoreContext.Provider>\n    );\n};\n\nconst useStore = () => {\n    return useContext(StoreContext);\n\n    // Used as custom-hook;\n    // const store = useStore();\n    //\n    // console.log(store)\n    // OUTPUT:\n    // {state: {…}, dispatch: ƒ}\n};\n\nStoreProvider.propTypes = {\n    children: PropTypes.object,\n};\n\nexport { StoreProvider, StoreContext, useStore };\n","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { Outlet, Navigate } from 'react-router-dom';\nimport { useStore } from '../store';\nimport { ROUTE_PATH } from '../constants';\n\nconst ProtectedRoutes = ({ allowedRoles }) => {\n    const {\n        state: { auth },\n    } = useStore();\n\n    if (!auth.isValid) {\n        return <Navigate replace to={ROUTE_PATH.sign_in} />;\n    }\n\n    return auth.roles.find((role) => allowedRoles?.includes(role)) ? (\n        <Outlet />\n    ) : (\n        <Navigate replace to={ROUTE_PATH.unauthorized} />\n    );\n};\n\nexport default ProtectedRoutes;\n","// Import the functions you need from the SDKs you need\nimport { initializeApp } from 'firebase/app';\n// import { getAnalytics } from 'firebase/analytics';\nimport {\n    getFirestore,\n    collection,\n    query,\n    where,\n    getDocs,\n} from 'firebase/firestore';\nimport { getAuth } from 'firebase/auth';\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\nconst firebaseConfig = {\n    apiKey: 'AIzaSyDZbsYnhDAV0SWjJw2e81ShRNuNRbz4-iQ',\n    authDomain: 'physical-therapy-system.firebaseapp.com',\n    projectId: 'physical-therapy-system',\n    storageBucket: 'physical-therapy-system.appspot.com',\n    messagingSenderId: '411714019674',\n    appId: '1:411714019674:web:669257e2726581c3525363',\n    measurementId: 'G-93J05VGEJN',\n};\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n// const analytics = getAnalytics(app);\nconst db = getFirestore(app);\nexport const auth = getAuth(app);\n\nexport const usersRef = collection(db, 'users');\nexport const recordsRef = collection(db, 'records');\nexport const difficultiesRef = collection(db, 'difficulties');\n\nexport const validateInputPairId = async (pairId) => {\n    const q = query(recordsRef, where('pairId', '==', pairId));\n    const querySnapshot = await getDocs(q);\n\n    if (querySnapshot.empty || querySnapshot.size != 1) {\n        return false;\n    }\n\n    let record;\n    let recordId;\n    querySnapshot.forEach((doc) => {\n        record = doc.data();\n        recordId = doc.id;\n    });\n\n    if (record?.finishedWorkoutTime != null) {\n        return false;\n    }\n\n    return recordId;\n};\n\nexport const getRpmsWithPairdId = async (pairId) => {\n    let targetRecordId = null;\n\n    const q = query(recordsRef, where('pairId', '==', pairId));\n    const querySnapshot = await getDocs(q);\n\n    if (querySnapshot.empty) {\n        return null;\n    }\n    if (querySnapshot.size == 1) {\n        querySnapshot.forEach((doc) => {\n            targetRecordId = doc.id;\n        });\n    }\n    console.log(targetRecordId);\n    return collection(recordsRef, targetRecordId, 'rpms');\n};\n\nexport const generateValidPairId = async () => {\n    let pass = false;\n    let pairId = null;\n\n    while (!pass) {\n        const test = getRandomPairId();\n        const validated = await isPairIdValid(test);\n\n        if (validated) {\n            pass = true;\n            pairId = test;\n        }\n    }\n\n    return pairId;\n};\n\nconst isPairIdValid = async (pairId) => {\n    const q = query(recordsRef, where('pairId', '==', pairId));\n    const querySnapshot = await getDocs(q);\n\n    if (querySnapshot.empty) {\n        return true;\n    } else return false;\n};\n\nconst getRandomPairId = () => {\n    return Math.floor(Math.random() * (9999 - 1000) + 1000).toString();\n};\n","/* eslint-disable no-unused-vars */\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Layout, Input, Button, message, Form, Typography } from 'antd';\nimport { signInWithEmailAndPassword } from 'firebase/auth';\n\n// import Header from '../../components/Header';\nimport styles from './styles.module.scss';\nimport { ROUTE_PATH, ROLES } from '../../constants';\nimport { useStore } from '../../store';\nimport { SET_AUTH } from '../../store/actions';\nimport { auth } from '../../services/firebase';\n\nconst { Content } = Layout;\nconst { Title } = Typography;\n\nconst SignIn = () => {\n    const navigate = useNavigate();\n    const [form] = Form.useForm();\n    const { dispatch } = useStore();\n    const [loading, setLoading] = useState(false);\n\n    const login = async () => {\n        try {\n            setLoading(true);\n\n            const values = await form.validateFields();\n            console.log(values);\n\n            const userCredential = await signInWithEmailAndPassword(\n                auth,\n                values.email,\n                values.password,\n            );\n\n            const user = userCredential.user;\n            setLoading(false);\n            dispatch({\n                type: SET_AUTH,\n                payload: {\n                    isValid: true,\n                    roles: [ROLES.Admin],\n                },\n            });\n\n            goDashboard();\n        } catch (e) {\n            console.log(e);\n            console.log(e?.message);\n            setLoading(false);\n            message.error('帳號或密碼有誤。');\n        }\n    };\n\n    const goDashboard = () => {\n        navigate(ROUTE_PATH.admin_dashbaord, { replace: true });\n    };\n\n    return (\n        <Layout>\n            <Content className=\"site-layout\" style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <Form\n                        {...formLayout}\n                        form={form}\n                        layout=\"horizontal\"\n                        autoComplete=\"off\"\n                    >\n                        <Form.Item\n                            label=\" \"\n                            colon={false}\n                            style={{ marginBottom: 12 }}\n                        >\n                            <Title level={2}>長庚大學-物理治療系統登入</Title>\n                        </Form.Item>\n                        <Form.Item\n                            label=\"Email\"\n                            name=\"email\"\n                            rules={[\n                                {\n                                    required: true,\n                                    message: '請填入 Email',\n                                },\n                            ]}\n                        >\n                            <Input placeholder=\"\" type=\"email\" />\n                        </Form.Item>\n                        <Form.Item\n                            label=\"Password\"\n                            name=\"password\"\n                            rules={[\n                                {\n                                    required: true,\n                                    message: '請填入 Password',\n                                },\n                            ]}\n                        >\n                            <Input.Password placeholder=\"\" />\n                        </Form.Item>\n                        <Form.Item {...tailLayout}>\n                            <Button\n                                type=\"primary\"\n                                htmlType=\"submit\"\n                                onClick={login}\n                                loading={loading}\n                            >\n                                登入\n                            </Button>\n                        </Form.Item>\n                    </Form>\n                </div>\n            </Content>\n        </Layout>\n    );\n};\n\nconst formLayout = {\n    labelCol: {\n        span: 7,\n    },\n    wrapperCol: {\n        span: 12,\n    },\n};\n\nconst tailLayout = {\n    wrapperCol: {\n        offset: 7,\n        span: 16,\n    },\n};\n\nexport default SignIn;\n","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n    TeamOutlined,\n    SlidersOutlined,\n    ProfileOutlined,\n    RocketOutlined,\n} from '@ant-design/icons';\n\nimport { ROUTE_PATH } from '../../constants';\nimport styles from './styles.module.scss';\n\nimport addOnImg from '../../assets/images/right-arrow.png';\n\nconst AdminDashboard = () => {\n    const navigate = useNavigate();\n    // const { pathname } = useLocation();\n\n    const goUserList = () => {\n        navigate(ROUTE_PATH.user_list);\n    };\n\n    const goDifficulityList = () => {\n        navigate(ROUTE_PATH.difficulty_list);\n    };\n\n    const goRecordList = () => {\n        navigate(`${ROUTE_PATH.record_list}/123`);\n    };\n\n    const goPrepareWorkout = () => {\n        navigate(ROUTE_PATH.prepare_workout);\n        // navigate(ROUTE_PATH.prepare_workout, { replace: true }); // 若要防止左滑上一頁\n    };\n\n    return (\n        <div className={styles.container}>\n            <legend>～選擇您的操作～</legend>\n            <fieldset>\n                <TileWithIconAndAction\n                    icon={<TeamOutlined />}\n                    label=\"騎乘者設定\"\n                    action={goUserList}\n                />\n\n                <TileWithIconAndAction\n                    icon={<SlidersOutlined />}\n                    label=\"騎乘關卡設定\"\n                    action={goDifficulityList}\n                />\n\n                <TileWithIconAndAction\n                    icon={<ProfileOutlined />}\n                    label=\"騎乘紀錄查詢\"\n                    action={goRecordList}\n                />\n\n                <TileWithIconAndAction\n                    icon={<RocketOutlined />}\n                    label=\"開始騎乘作業\"\n                    action={goPrepareWorkout}\n                />\n            </fieldset>\n        </div>\n    );\n};\n\nconst TileWithIconAndAction = ({ icon, label, action }) => (\n    <span className={styles.tile} onClick={action}>\n        <span\n            className={styles.addOn}\n            style={{ backgroundImage: `url(${addOnImg})` }}\n        ></span>\n        <span className={styles.tileIcon}>{icon}</span>\n        <span className={styles.tileLabel}>{label}</span>\n    </span>\n);\n\nexport default AdminDashboard;\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgEAYAAAAj6qa3AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAAAB3RJTUUH5gUPACMKwjZTZgAAAfBJREFUaN7tmDFLHEEYht9vPRRJc+lCtHDXI4V/ICmEQIo0IhbeIqIwe4USPLwmXQIGhAuBYHPdieEInN6pVRCSIm0qC0VCmsREUBELYykSb/dNEfYKg8jhruvgPM0UMwzf+8B8wwxgMBgMBoM29K24WQbt7YDrkm1tSddzbdgzao3M5520Inl66uS9DfL42P6tFsjh4aTri41Mafojg46OZnDH80gyHO26+kWenfUO5e6TIyOt7m8lHfAytguHFUijgTHZBE5Ozs/LC5kFUqlgNPgCVKutirjxAoDVVRHf5yw3gIkJvuYM0GhEJUKSjtcqdjFXZJDNojcYhdRqYfD/Fj6DDfg+v8su6Hk7C5V3YlWr2guIWoS2AqISIY6jSuTAAOfEB8pleY4toKsr6WBxEfYQ6y1swHXF/qZ+kHt7MihFoLs76QKvTcQaXwL7+xrcAjHxQKYB0rL6+RWYnAyNJF1X3DSPwCN+AgoF/Ztgj6cYuC7e8BVkaenSJviQGUCpncfvx0QWF7UVcNXg4bR2AqIKrp2A5qvvM54A9fpFwZtnvGb1A+PjPz9UDkSWly/aVwMB/979ztM7d4GjI2zjD5BOXzV4yI2/BjOlezkwlcI6y0BnZ1TBtcPe9ObJqalb9yFynlv7JWYwGAyGGPgL5etGn1vyhAgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDUtMTVUMDA6MzU6MTArMDA6MDBS2JlGAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA1LTE1VDAwOjM1OjEwKzAwOjAwI4Uh+gAAAABJRU5ErkJggg==\"","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { ROUTE_PATH } from '../../constants/';\n\nimport styles from './styles.module.scss';\n\nconst Header = () => {\n    return (\n        <div className={styles.container}>\n            <Link to={ROUTE_PATH.admin_dashbaord}>Dashboard</Link>\n        </div>\n    );\n};\n\nexport default Header;\n","import React from 'react';\n\nimport Header from '../../components/Header';\nimport styles from './styles.module.scss';\n\nconst Missing = () => {\n    return (\n        <div className={styles.container}>\n            <Header />\n            <h1>!NOT FOUND!</h1>\n            <p>Sorry, the page you visited is not exist</p>\n        </div>\n    );\n};\n\nexport default Missing;\n","import React from 'react';\n\nimport Header from '../../components/Header';\nimport styles from './styles.module.scss';\n\nconst Unauthorized = () => {\n    return (\n        <div className={styles.container}>\n            <Header />\n            <p>Sorry, you are not authorized to view this page</p>\n        </div>\n    );\n};\n\nexport default Unauthorized;\n","import _ from 'underscore';\nimport React from 'react';\n\nclass Helper {\n    defaults(object, defaults) {\n        return _.defaults({ ...object }, defaults);\n    }\n    each(list, iteratee, context) {\n        if (list instanceof Set) {\n            let array = Array.from(list);\n            array.forEach((value, index, array) =>\n                iteratee.call(context, value, index, array),\n            );\n        } else {\n            _.each(list, iteratee, context);\n        }\n    }\n\n    map(list, iteratee, context) {\n        return _.map(list, iteratee, context);\n    }\n\n    mapObject(obj, iteratee, context) {\n        return _.mapObject(obj, iteratee, context);\n    }\n\n    reduce(list, iteratee, memo, context) {\n        return _.reduce(list, iteratee, memo, context);\n    }\n\n    every(list, iteratee, context) {\n        return _.every(list, iteratee, context);\n    }\n\n    some(list, iteratee, context) {\n        return _.some(list, iteratee, context);\n    }\n\n    find(list, predicate, context) {\n        let result = null;\n        if (list instanceof Map) {\n            for (const entry of list.entries()) {\n                let value = entry[1];\n                let key = entry[0];\n                let test = predicate.call(context, value, key, list);\n                if (test) {\n                    result = value;\n                    break;\n                }\n            }\n        } else {\n            result = _.find(list, predicate, context);\n        }\n        return result;\n    }\n\n    findIndex(list, predicate, context) {\n        return _.findIndex(list, predicate, context);\n    }\n\n    filter(list, predicate, context) {\n        return _.filter(list, predicate, context);\n    }\n\n    count(list, predicate, context) {\n        return this.filter(list, predicate, context).length;\n    }\n\n    max(list, iteratee, context) {\n        return _.max(list, iteratee, context);\n    }\n\n    min(list, iteratee, context) {\n        return _.min(list, iteratee, context);\n    }\n\n    toArray(any) {\n        if (this.isValid(any)) {\n            return _.isArray(any) ? any : [any];\n        } else {\n            return any;\n        }\n    }\n    first(array, n) {\n        return _.isEmpty(array) ? null : _.first(array, n);\n    }\n\n    last(array, n) {\n        return _.isEmpty(array) ? null : _.last(array, n);\n    }\n\n    has(object, key) {\n        return _.has(object, key);\n    }\n\n    values(object) {\n        return _.values(object);\n    }\n\n    isEqual(a, b) {\n        let test = true;\n        if (a instanceof File && b instanceof File) {\n            test = a.size === b.size;\n        } else if (this.isArray(a) && this.isArray(b)) {\n            for (let i = 0; i < Math.max(a.length, b.length); i++) {\n                if (a[i] !== b[i]) {\n                    test = false;\n                    break;\n                }\n            }\n        } else {\n            test = JSON.stringify(a) === JSON.stringify(b);\n        }\n        return test;\n    }\n    isEmpty(value) {\n        let test = false;\n        if (this.isNullOrUndefined(value)) {\n            test = true;\n        } else if (_.isString(value) || _.isArray(value)) {\n            test = value.length === 0;\n        } else if (!this.isPrimitive(value)) {\n            test = Object.entries(value).length === 0;\n        }\n        return test;\n    }\n    isNotEmpty(object) {\n        return !this.isEmpty(object);\n    }\n    isBoolean(object) {\n        return _.isBoolean(object);\n    }\n    isFalse(value) {\n        return value === false;\n    }\n    isTrue(value) {\n        return value === true;\n    }\n    isString(object) {\n        return _.isString(object);\n    }\n    isNumber(object) {\n        return _.isNumber(object);\n    }\n    isFunction(object) {\n        return _.isFunction(object);\n    }\n    isDate(object) {\n        return _.isDate(object);\n    }\n    isNull(...values) {\n        return values.every((value) => _.isNull(value));\n    }\n    isNotNull(...values) {\n        return values.every((value) => !_.isNull(value));\n    }\n    isUndefined(...values) {\n        return values.every((value) => _.isUndefined(value));\n    }\n    isNotUndefined(...values) {\n        return values.every((value) => !_.isUndefined(value));\n    }\n    isNullOrUndefined(...values) {\n        return values.every(\n            (value) => this.isNull(value) || this.isUndefined(value),\n        );\n    }\n    isNotNullOrUndefined(...values) {\n        return values.every((value) => !this.isNullOrUndefined(value));\n    }\n    isExisted(object) {\n        return !(object === null || object === undefined);\n    }\n    isNotExisted(object) {\n        return object === null || object === undefined;\n    }\n    isValid(object) {\n        return this.isExisted(object);\n    }\n    isNotValid(object) {\n        return this.isNotExisted(object);\n    }\n    isArray(object) {\n        return Array.isArray(object);\n    }\n    isObject(object) {\n        return _.isObject(object);\n    }\n    isInteger(object) {\n        return Number.isInteger(object);\n    }\n    isFinite(value) {\n        return Number.isFinite(value);\n    }\n    isFile(object) {\n        return object instanceof File;\n    }\n    isNaN(object) {\n        return _.isNaN(object);\n    }\n    isPrimitive(value) {\n        return (\n            this.isNumber(value) ||\n            this.isString(value) ||\n            this.isDate(value) ||\n            this.isBoolean(value) ||\n            this.isFile(value)\n        );\n    }\n    isJson(json) {\n        if (!_.isString(json)) return false;\n\n        try {\n            JSON.parse(json);\n        } catch (e) {\n            return false;\n        }\n        return true;\n    }\n    isPojo(object) {\n        if (object == null || typeof object !== 'object') {\n            return false;\n        }\n        const proto = Object.getPrototypeOf(object);\n        if (proto == null) {\n            return true; // `Object.create(null)`\n        }\n        return proto === Object.prototype;\n    }\n    isElement(object) {\n        return React.isValidElement(object);\n    }\n}\n\nlet helper = new Helper();\n\nexport default helper;\n","export default function wait(ms, value) {\n    return new Promise((resolve) => setTimeout(resolve, ms, value));\n}\n","/* eslint-disable no-unused-vars */\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n    addDoc,\n    collection,\n    onSnapshot,\n    doc,\n    updateDoc,\n    deleteDoc,\n    Timestamp,\n    getDocs,\n    query,\n    where,\n} from 'firebase/firestore';\nimport {\n    Statistic,\n    Layout,\n    Form,\n    PageHeader,\n    Input,\n    Button,\n    message,\n    Modal,\n    Select,\n    Divider,\n    Popover,\n    Spin,\n    Row,\n    Col,\n    Descriptions,\n    Typography,\n    Badge,\n} from 'antd';\nimport {\n    LoadingOutlined,\n    ExclamationCircleOutlined,\n    SettingOutlined,\n    ArrowRightOutlined,\n} from '@ant-design/icons';\nimport _ from '../../util/helper';\n\nimport { ROUTE_PATH, VALID_MIN, WARN_THRESHOLD, WARN } from '../../constants';\nimport styles from './styles.module.scss';\n\nimport {\n    usersRef,\n    difficultiesRef,\n    recordsRef,\n    generateValidPairId,\n    validateInputPairId,\n} from '../../services/firebase';\nimport wait from '../../util/wait';\n\nconst { Countdown } = Statistic;\nconst { Content } = Layout;\nconst { Option } = Select;\nconst { Text } = Typography;\n\nconst initialPacket = {\n    rpm: 0,\n    time: 0,\n    heartRate: 0,\n};\n\nlet unsubscribe = null;\n\nconst PrepareWorkout = () => {\n    const navigate = useNavigate();\n    const [form] = Form.useForm();\n\n    const [users, setUsers] = useState();\n    const [difficulties, setDifficulties] = useState([]);\n    const [isDone, setIsDone] = useState(false);\n\n    // store [id]\n    const [selectedUser, setSelectedUser] = useState();\n    const [selectedDiff, setSelectedDiff] = useState();\n\n    // 提供查看[使用者], [關卡]所需資訊。store data object\n    const [selectedUserData, setSelectedUserData] = useState();\n    const [selectedDiffData, setSelectedDiffData] = useState();\n    const [userModalVis, setUserModalVis] = useState(false);\n    const [diffModalVis, setDiffModalVis] = useState(false);\n\n    //\n    // 顯示”當前關卡“各階段警示心率的值\n    const [warnHRValues, setWarnHRValues] = useState([]);\n    //\n    //\n\n    const [isPairing, setIsPairing] = useState(false);\n\n    const [targetgetRecordId, setTargetRecordId] = useState();\n\n    const [pairId, setPairId] = useState(); // 產生的不重複配對碼\n    const [isAppConnected, setIsAppConnected] = useState(false);\n    const [pairDeadline, setPairDeadline] = useState();\n\n    // for functionality testing\n    const [inputPairId, setInputPairId] = useState(''); // 輸入的配對碼\n\n    useEffect(() => {\n        init();\n\n        return () => {\n            if (_.isFunction(unsubscribe)) unsubscribe();\n        };\n    }, []);\n\n    const init = async () => {\n        const users = await fetchUsers();\n        const difficulties = await fetchDiffs();\n\n        setUsers(users);\n        setDifficulties(difficulties);\n        setIsDone(true);\n    };\n\n    useEffect(() => {\n        if (_.isEmpty(targetgetRecordId)) {\n            return;\n        }\n\n        const targetRecordRef = doc(recordsRef, targetgetRecordId);\n        unsubscribe = onSnapshot(targetRecordRef, async (doc) => {\n            const currData = doc.data();\n            if (currData?.pairId == null) {\n                // App 端連線後，會將 pairId 設成 null\n                // 藉由監聽是否為 null，判斷是否連上\n                // 若連上更新 record 的 [isAppConnected] 為 true\n                if (currData?.isAppConnected == false) {\n                    await updateDoc(targetRecordRef, {\n                        isAppConnected: true,\n                    });\n\n                    setPairDeadline(null);\n                    setIsPairing(false);\n                    setIsAppConnected(true);\n                    message.success('配對成功，您可以前往監視畫面了！');\n                }\n            }\n        });\n\n        // going to listen doc change!\n    }, [targetgetRecordId]);\n\n    const fetchUsers = async () => {\n        const q = query(usersRef, where('isDeleted', '!=', true));\n\n        const users = [];\n        const querySnapshot = await getDocs(q);\n        querySnapshot.forEach((doc) => {\n            users.push({\n                ...doc.data(),\n                id: doc.id,\n            });\n        });\n\n        return users;\n    };\n\n    const fetchDiffs = async () => {\n        const q = query(difficultiesRef, where('isDeleted', '!=', true));\n\n        const difficulties = [];\n        const querySnapshot = await getDocs(q);\n        querySnapshot.forEach((doc) => {\n            difficulties.push({\n                ...doc.data(),\n                id: doc.id,\n            });\n        });\n\n        return difficulties;\n    };\n\n    const goDashboard = async () => {\n        if (targetgetRecordId) {\n            Modal.confirm({\n                title: '即將離開！',\n                icon: <ExclamationCircleOutlined />,\n                content: '將刪除所選資訊',\n                onOk: () => deleteRecord('leave'),\n            });\n        } else {\n            navigate(ROUTE_PATH.admin_dashbaord);\n        }\n    };\n\n    const goMonitoring = () => {\n        navigate(`${ROUTE_PATH.monitoring_workout}/${targetgetRecordId}`, {\n            replace: true,\n        });\n    };\n\n    const confirmUserAndDiff = async () => {\n        const valid = await form.validateFields();\n\n        console.log(valid);\n\n        Modal.confirm({\n            title: '即將產生配對碼！',\n            icon: <ExclamationCircleOutlined />,\n            content: '資料一旦輸入將無法進行修改，請確認無誤！',\n            onOk: () => createRecord(),\n        });\n    };\n\n    const createRecord = async () => {\n        if (selectedUser == null || selectedDiff == null) {\n            return;\n        }\n\n        const theDiff = difficulties.find((d) => d.id === selectedDiff);\n\n        const targetHeartRate = theDiff.targetHeartRate; // careful the type\n        const upperLimitHeartRate = theDiff.upperLimitHeartRate; // careful the type\n        // constant\n        const user = selectedUser;\n        const difficulty = selectedDiff;\n        const pairId = await generateValidPairId();\n        const isAppConnected = false;\n        const createdTime = Timestamp.now();\n        const beginWorkoutTime = null;\n        const finishedWorkoutTime = null;\n\n        const targetRecordRef = await addDoc(recordsRef, {\n            targetHeartRate,\n            upperLimitHeartRate,\n            pairId,\n            isAppConnected,\n            user,\n            createdTime,\n            beginWorkoutTime,\n            finishedWorkoutTime,\n            difficulty,\n        });\n        console.log('Document written with ID: ', targetRecordRef.id);\n\n        // initialize sub collection - packets\n        await addDoc(\n            collection(recordsRef, targetRecordRef.id, 'packets'),\n            initialPacket,\n        );\n\n        setTargetRecordId(targetRecordRef.id);\n        setPairId(pairId);\n\n        // start a count-down\n        const deadline = Date.now() + 1000 * 60 * VALID_MIN;\n        setPairDeadline(deadline);\n\n        message.info({ content: '配對碼已生成！請在時間內進行配對！' }, 5);\n\n        // targetHeartRate\n        // upperLimitHeartRate\n        // pairId\n        // isAppConnected\n        // user\n        // beginWorkoutTime\n        // finishedWorkoutTime\n        // createdTime\n        // difficulty\n    };\n\n    const deleteRecord = async (leave = false) => {\n        const targetRecordRef = doc(recordsRef, targetgetRecordId);\n        await deleteDoc(targetRecordRef);\n        if (leave) navigate(ROUTE_PATH.admin_dashbaord);\n    };\n\n    // for functionality testing\n    const pairWithApp = async () => {\n        setIsPairing(true);\n\n        const theRecordId = await validateInputPairId(inputPairId);\n\n        if (!theRecordId) {\n            alert('配對碼有誤或非本次記錄的配對碼');\n            setIsPairing(false);\n            setIsAppConnected(false);\n            return;\n        }\n\n        // update the isAppConnected Field!\n        const targetRecordRef = doc(recordsRef, theRecordId);\n        await wait(1500);\n        await updateDoc(targetRecordRef, {\n            pairId: null,\n        });\n    };\n\n    const onDeadlineExpired = async () => {\n        message.warn('連結過期，請重新選擇！', 3);\n\n        await wait(1000);\n        await deleteRecord();\n        setTargetRecordId(null);\n        setPairId(null);\n        setSelectedUser();\n        setSelectedDiff();\n        setPairDeadline(null);\n        setInputPairId(null);\n        form.resetFields();\n    };\n\n    const onUserChange = (value) => setSelectedUser(value);\n    const onDiffChange = (value) => setSelectedDiff(value);\n\n    const openUserModal = () => {\n        const selectedUserData = users.find((u) => u.id === selectedUser);\n\n        setUserModalVis(true);\n        setSelectedUserData(selectedUserData);\n    };\n    const openDiffModal = () => {\n        const selectedDiffData = difficulties.find(\n            (d) => d.id === selectedDiff,\n        );\n        const warnHRValues = getExactThresholdValue(\n            selectedDiffData.upperLimitHeartRate,\n        );\n\n        setDiffModalVis(true);\n        setSelectedDiffData(selectedDiffData);\n        setWarnHRValues(warnHRValues);\n    };\n    const closeUserModal = () => {\n        setUserModalVis(false);\n        setSelectedUserData();\n    };\n    const closeDiffModal = () => {\n        setDiffModalVis(false);\n        setSelectedDiffData();\n    };\n\n    const getExactThresholdValue = (upperLimitHeartRate) => {\n        if (!_.isNumber(upperLimitHeartRate)) {\n            return;\n        }\n\n        const calBase = upperLimitHeartRate / 100;\n\n        const overHigh = Math.ceil(calBase * WARN_THRESHOLD.High);\n        const overMedium = Math.ceil(calBase * WARN_THRESHOLD.Medium);\n        const overSlight = Math.ceil(calBase * WARN_THRESHOLD.Slight);\n\n        return [overSlight, overMedium, overHigh];\n    };\n\n    const simulateAppCotent = (\n        <div className={styles.pairing}>\n            <Input.Search\n                placeholder=\"手動輸入配對碼\"\n                allowClear\n                value={inputPairId}\n                onChange={(e) => setInputPairId(e.target.value)}\n                onSearch={pairWithApp}\n                disabled={isAppConnected}\n                loading={isPairing}\n            />\n            {/* <Button onClick={pairWithApp} disabled={isAppConnected}>\n                我要配對\n            </Button> */}\n        </div>\n    );\n\n    if (!isDone) {\n        return (\n            <Layout style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        className={styles.PageHeader}\n                        title=\"資料讀取中...\"\n                    />\n                </div>\n            </Layout>\n        );\n    }\n\n    return (\n        <Layout>\n            <Content className=\"site-layout\" style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        className={styles.PageHeader}\n                        title=\"準備騎乘！進行騎乘設定\"\n                        subTitle=\"選擇騎乘者及關卡資訊\"\n                        onBack={goDashboard}\n                    />\n\n                    <Form {...formLayout} form={form} style={{ marginTop: 36 }}>\n                        <Form.Item\n                            name=\"user\"\n                            label=\"騎乘者\"\n                            rules={[\n                                {\n                                    required: true,\n                                    message: '請選擇騎乘者',\n                                },\n                            ]}\n                        >\n                            <Row gutter={8}>\n                                <Col span={18}>\n                                    <Select\n                                        placeholder=\"選擇騎乘者\"\n                                        onChange={onUserChange}\n                                        disabled={pairId}\n                                    >\n                                        {users.map((user) => (\n                                            <Option\n                                                value={user.id}\n                                                key={user.id}\n                                            >\n                                                {user.name}\n                                            </Option>\n                                        ))}\n                                    </Select>\n                                </Col>\n                                <Col span={6}>\n                                    <Button\n                                        disabled={!selectedUser}\n                                        onClick={openUserModal}\n                                    >\n                                        查看騎乘者資訊\n                                    </Button>\n                                </Col>\n                            </Row>\n                        </Form.Item>\n                        <Form.Item\n                            name=\"difficulty\"\n                            label=\"關卡資訊\"\n                            rules={[\n                                {\n                                    required: true,\n                                    message: '請選擇關卡資訊',\n                                },\n                            ]}\n                        >\n                            <Row gutter={8}>\n                                <Col span={18}>\n                                    <Select\n                                        placeholder=\"選擇關卡資訊\"\n                                        onChange={onDiffChange}\n                                        disabled={pairId}\n                                    >\n                                        {difficulties.map((diff) => (\n                                            <Option\n                                                value={diff.id}\n                                                key={diff.id}\n                                            >\n                                                {diff.name}・\n                                                {diff.targetWorkoutTime}{' '}\n                                                分鐘・目標{' '}\n                                                {diff.targetHeartRate} BPM\n                                            </Option>\n                                        ))}\n                                    </Select>\n                                </Col>\n                                <Col span={6}>\n                                    <Button\n                                        disabled={!selectedDiff}\n                                        onClick={openDiffModal}\n                                    >\n                                        查看關卡資訊\n                                    </Button>\n                                </Col>\n                            </Row>\n                        </Form.Item>\n                        <Form.Item {...tailLayout}>\n                            <Button\n                                type=\"primary\"\n                                htmlType=\"submit\"\n                                onClick={confirmUserAndDiff}\n                                disabled={pairId}\n                            >\n                                下一步，生成配對碼\n                            </Button>\n                        </Form.Item>\n                    </Form>\n\n                    <Modal\n                        title=\"檢視騎乘者\"\n                        visible={userModalVis}\n                        onCancel={closeUserModal}\n                        footer={null} // no [Ok], [Cancel] button\n                    >\n                        <Descriptions\n                            bordered\n                            className={styles.descriptions}\n                            size=\"middle\"\n                        >\n                            <Descriptions.Item label=\"騎乘者姓名\" span={3}>\n                                {selectedUserData?.name}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"騎乘者身體年齡\" span={3}>\n                                {selectedUserData?.age}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"備註\" span={3}>\n                                {selectedUserData?.note}\n                            </Descriptions.Item>\n                        </Descriptions>\n                    </Modal>\n                    <Modal\n                        title=\"檢視難度\"\n                        visible={diffModalVis}\n                        onCancel={closeDiffModal}\n                        footer={null} // no [Ok], [Cancel] button\n                        width={600}\n                    >\n                        <Descriptions\n                            bordered\n                            className={styles.descriptions}\n                            size=\"middle\"\n                            column={2}\n                        >\n                            <Descriptions.Item label=\"難度名稱\" span={1}>\n                                {selectedDiffData?.name}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"目標騎乘時間\" span={1}>\n                                {selectedDiffData?.targetWorkoutTime} 分\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"目標心率數值\" span={2}>\n                                {selectedDiffData?.targetHeartRate}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"上限心率數值\" span={2}>\n                                {selectedDiffData?.upperLimitHeartRate}\n                            </Descriptions.Item>\n                            <Descriptions.Item\n                                label={\n                                    <>\n                                        警示心率門檻\n                                        <br />\n                                        <Text\n                                            type=\"secondary\"\n                                            style={{\n                                                fontSize: '0.8em',\n                                            }}\n                                        >\n                                            依據上限心率數值計算\n                                        </Text>\n                                    </>\n                                }\n                                span={2}\n                            >\n                                <Badge\n                                    color=\"blue\"\n                                    text={WarnHRValueDisplay(\n                                        warnHRValues?.[0],\n                                        WARN.Slight,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n\n                                <Badge\n                                    color=\"gold\"\n                                    text={WarnHRValueDisplay(\n                                        warnHRValues?.[1],\n                                        WARN.Medium,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n\n                                <Badge\n                                    color=\"volcano\"\n                                    text={WarnHRValueDisplay(\n                                        warnHRValues?.[2],\n                                        WARN.High,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"備註\" span={2}>\n                                {selectedDiffData?.note}\n                            </Descriptions.Item>\n                        </Descriptions>\n                    </Modal>\n\n                    {pairId && (\n                        <>\n                            <Divider\n                                dashed={true}\n                                style={{\n                                    minWidth: '90%',\n                                    width: '90%',\n                                    borderWidth: '2px',\n                                    margin: 'auto',\n                                    marginRight: 'auto',\n                                    marginTop: '4em',\n                                    marginBottom: '4em',\n                                }}\n                            />\n                            <Form {...formLayout}>\n                                <Form.Item\n                                    label={\n                                        <>\n                                            配對碼\n                                            <Popover\n                                                content={simulateAppCotent}\n                                                placement=\"bottomRight\"\n                                                title=\"更多操作\"\n                                                trigger=\"click\"\n                                            >\n                                                <SettingOutlined\n                                                    width={'1em'}\n                                                />\n                                            </Popover>\n                                        </>\n                                    }\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                >\n                                    <div className={styles.pairIdWrapper}>\n                                        {pairId.split('').map((c, i) => (\n                                            <pre key={c + i}>{c}</pre>\n                                        ))}\n\n                                        {/* <Countdown\n                                            title=\"有效時間\"\n                                            value={Date.now() + 1000 * 60 * 10}\n                                            onFinish={onDeadlineExpired}\n                                        /> */}\n                                        {pairDeadline && (\n                                            <Countdown\n                                                title=\"有效時間\"\n                                                value={pairDeadline}\n                                                onFinish={onDeadlineExpired}\n                                            />\n                                        )}\n                                    </div>\n                                </Form.Item>\n                                {!isAppConnected && (\n                                    <Form.Item\n                                        label=\" \"\n                                        colon={false}\n                                        style={{ marginTop: '3em' }}\n                                    >\n                                        <Spin\n                                            indicator={\n                                                <LoadingOutlined\n                                                    style={{\n                                                        fontSize: 24,\n                                                        marginRight: '1em',\n                                                    }}\n                                                    spin\n                                                />\n                                            }\n                                        />\n                                        等待配對中...\n                                    </Form.Item>\n                                )}\n\n                                <Form.Item\n                                    label=\" \"\n                                    colon={false}\n                                    style={{ marginTop: '5em' }}\n                                >\n                                    <Button\n                                        onClick={goMonitoring}\n                                        type={\n                                            isAppConnected\n                                                ? 'primary'\n                                                : 'dashed'\n                                        }\n                                        disabled={!isAppConnected}\n                                        icon={\n                                            isAppConnected && (\n                                                <ArrowRightOutlined />\n                                            )\n                                        }\n                                        size=\"large\"\n                                    >\n                                        前往監視畫面\n                                    </Button>\n                                </Form.Item>\n                            </Form>\n                        </>\n                    )}\n                </div>\n            </Content>\n        </Layout>\n    );\n};\n\nconst WarnHRValueDisplay = (value, warn) => {\n    let phase;\n    let overVal;\n    if (warn === WARN.Slight) {\n        phase = '一';\n        overVal = WARN_THRESHOLD.Slight - 100;\n    }\n    if (warn === WARN.Medium) {\n        phase = '二';\n        overVal = WARN_THRESHOLD.Medium - 100;\n    }\n    if (warn === WARN.High) {\n        phase = '三';\n        overVal = WARN_THRESHOLD.High - 100;\n    }\n\n    return (\n        <div style={{ display: 'flex' }}>\n            第{phase}階段：{value}\n            <Text type=\"secondary\" style={{ fontSize: '0.85em' }}>\n                （超出 {overVal}％）\n            </Text>\n        </div>\n    );\n};\n\nconst formLayout = {\n    labelCol: {\n        span: 8,\n    },\n    wrapperCol: {\n        span: 10,\n    },\n};\n\nconst tailLayout = {\n    wrapperCol: {\n        offset: 8,\n        span: 16,\n    },\n};\n\nexport default PrepareWorkout;\n","export default __webpack_public_path__ + \"static/media/warn-slight.5b9ecb19.wav\";","export default __webpack_public_path__ + \"static/media/warn-medium.44c98622.wav\";","export default __webpack_public_path__ + \"static/media/warn-high.ae9bf97e.wav\";","export default __webpack_public_path__ + \"static/media/notification.3047fa24.wav\";","export default __webpack_public_path__ + \"static/media/goal-archieved.105e220c.wav\";","import { useState } from 'react';\nimport { WARN } from '../constants/index';\nimport warn_slight_url from '../assets/sounds/warn-slight.wav';\nimport warn_medium_url from '../assets/sounds/warn-medium.wav';\nimport warn_high_url from '../assets/sounds/warn-high.wav';\nimport other_notification_url from '../assets/sounds/notification.wav';\nimport other_archieved_url from '../assets/sounds/goal-archieved.wav';\n\nconst OTHER_SOUND = {\n    Notification: 'notification',\n    Archieved: 'goal-archieved',\n};\n\n// To Address Safari on iPad issue:\n// Checkout: https://stackoverflow.com/questions/31776548/why-cant-javascript-play-audio-files-on-iphone-safari\n// ======>> \"iOS disables autoplay, instead requiring that\n//            play be initiated as part of a user interaction\n//           (e.g., you can start playback within a touchstart listener).\"\n// ======>> 透過只啟動一個 Audio 用更換來源網址達成播放不同聲音！！\nconst useAudio = () => {\n    const [audioPlayer] = useState(new Audio(other_notification_url));\n\n    const getAudioPermission = () => {\n        audioPlayer.play();\n    };\n\n    const playWarnSound = (warn) => {\n        switch (warn) {\n            case WARN.Slight:\n                audioPlayer.src = warn_slight_url;\n                audioPlayer.play();\n                break;\n            case WARN.Medium:\n                audioPlayer.src = warn_medium_url;\n                audioPlayer.play();\n                break;\n            case WARN.High:\n                audioPlayer.src = warn_high_url;\n                audioPlayer.play();\n                break;\n        }\n    };\n\n    const playOtherSound = (sound) => {\n        switch (sound) {\n            case OTHER_SOUND.Archieved:\n                audioPlayer.src = other_archieved_url;\n                audioPlayer.play();\n                break;\n            case OTHER_SOUND.Notification:\n                audioPlayer.play();\n                break;\n        }\n    };\n\n    return { getAudioPermission, playWarnSound, playOtherSound, OTHER_SOUND };\n};\n\nexport default useAudio;\n","const formatSeconds = (input) => {\n    const sec_num = parseInt(input, 10);\n    const hours = Math.floor(sec_num / 3600);\n    const minutes = Math.floor((sec_num - hours * 3600) / 60);\n    const seconds = sec_num - hours * 3600 - minutes * 60;\n\n    let formatted = '';\n    if (hours != 0) formatted += `${hours}時 `;\n    if (minutes != 0) formatted += `${minutes}分 `;\n    if (seconds != 0) formatted += `${seconds}秒`;\n\n    return formatted;\n};\n\nexport default formatSeconds;\n","const configLineChart = (data, targetHeartRate) => ({\n    data: [data, data],\n    xField: 'timeLabel',\n    yField: ['rpm', 'heartRate'],\n    yAxis: {\n        rpm: {\n            title: {\n                text: 'RPM',\n            },\n        },\n        heartRate: {\n            title: {\n                text: '心率',\n            },\n        },\n    },\n    // xAxis: {\n    //     title: {\n    //         text: '時間',\n    //     },\n    // },\n    legend: {\n        itemName: {\n            formatter: (text, item) => {\n                return item.value === 'rpm' ? 'RPM' : '心率';\n            },\n        },\n    },\n    meta: {\n        rpm: {\n            alias: 'RPM值 ',\n            formatter: (value) => {\n                return `${value} RPM`;\n            },\n        },\n        heartRate: {\n            alias: '心率',\n            formatter: (value) => {\n                return `${value} BPM`;\n                // return Number((v / 100).toFixed(1));\n            },\n        },\n    },\n    geometryOptions: [\n        {\n            geometry: 'line',\n            color: '#5B8FF9',\n            lineStyle: {\n                lineWidth: 2,\n                lineDash: [5, 5],\n            },\n        },\n        {\n            geometry: 'line',\n            color: '#5AD8A6',\n            smooth: true,\n            lineStyle: {\n                lineWidth: 4,\n                opacity: 0.5,\n            },\n            point: {\n                shape: 'circle',\n                size: 4,\n                style: {\n                    opacity: 0.5,\n                    stroke: '#5AD8A6',\n                    fill: '#fff',\n                },\n            },\n        },\n    ],\n    annotations: {\n        heartRate: [\n            {\n                type: 'line',\n                start: ['min', targetHeartRate], // TODO: change [138] to 目標心率\n                end: ['max', targetHeartRate], // TODO: change [138] to 目標心率\n                style: {\n                    lineWidth: 2,\n                    lineDash: [3, 3],\n                    stroke: '#F4664A',\n                },\n                text: {\n                    content: `目標心率(${targetHeartRate})`, // TODO: change [138] to 目標心率\n                    offsetY: -4,\n                    position: 'end',\n                    style: {\n                        textAlign: 'end',\n                    },\n                },\n            },\n        ],\n    },\n    tooltip: {\n        showTitle: true,\n    },\n});\n\nexport default configLineChart;\n","import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport styles from './styles.module.scss';\n\nconst StopWatch = ({ start, initialValue }) => {\n    const [time, setTime] = useState(initialValue);\n    const [miliDisplay, setMiliDisplay] = useState(0);\n\n    useEffect(() => {\n        let interval = null;\n        let displayInterval = null;\n\n        if (start) {\n            interval = setInterval(() => {\n                setTime((time) => time + 10);\n            }, 10);\n\n            displayInterval = setInterval(() => {\n                setMiliDisplay((miliDisplay) => {\n                    if (miliDisplay + 10 > 1000) return 0;\n                    else return miliDisplay + 10;\n                });\n            }, 10);\n        } else {\n            clearInterval(interval);\n            clearInterval(displayInterval);\n        }\n\n        return () => {\n            clearInterval(interval);\n            clearInterval(displayInterval);\n        };\n    }, [start]);\n\n    return (\n        <div className={styles.container}>\n            <span className=\"digits\">\n                {('0' + Math.floor(time / 3600000)).slice(-2)}:\n            </span>\n            <span className=\"digits\">\n                {('0' + Math.floor((time / 60000) % 60)).slice(-2)}:\n            </span>\n            <span className=\"digits\">\n                {('0' + Math.floor((time / 1000) % 60)).slice(-2)}.\n            </span>\n            <span className=\"digits mili-sec\">\n                {('0' + ((miliDisplay / 10) % 100)).slice(-2)}\n            </span>\n        </div>\n    );\n};\n\nStopWatch.propTypes = {\n    start: PropTypes.bool,\n    initialValue: PropTypes.number,\n};\n\nexport default StopWatch;\n","/* eslint-disable no-unused-vars */\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport {\n    onSnapshot,\n    collection,\n    addDoc,\n    doc,\n    updateDoc,\n    Timestamp,\n    getDoc,\n} from 'firebase/firestore';\nimport moment from 'moment';\nimport { DualAxes as LineChart } from '@ant-design/plots';\nimport { Modal, Popover, Button, Input, message, notification } from 'antd';\nimport {\n    SettingOutlined,\n    ExclamationCircleOutlined,\n    SmileOutlined,\n} from '@ant-design/icons';\n\nimport { ROUTE_PATH, WARN, WARN_THRESHOLD } from '../../constants';\nimport styles from './styles.module.scss';\nimport _ from '../../util/helper';\n\nimport { recordsRef, usersRef, difficultiesRef } from '../../services/firebase';\nimport wait from '../../util/wait';\nimport useAudio from '../../util/useAudio';\nimport formatWithMoment from '../../util/formatSeconds';\nimport configLineChart from '../../util/configLineChart';\n\nimport StopWatch from '../../components/StopWatch';\n\nlet unsubscribeRecord = null;\nlet unsubscribePackets = null;\n\nconst MonitoringWorkout = () => {\n    const navigate = useNavigate();\n    const params = useParams();\n\n    const [record, setRecord] = useState();\n    const [user, setUser] = useState();\n    const [difficulty, setDifficulty] = useState();\n    const [packets, setPackets] = useState([]);\n\n    const [isInitRecordDone, setIsInitRecordDone] = useState(false);\n    const [isInitPacketsDone, setIsInitPacketsDone] = useState(false);\n\n    const {\n        playWarnSound,\n        playOtherSound,\n        OTHER_SOUND,\n        getAudioPermission,\n    } = useAudio();\n\n    // 騎乘計時碼表\n    const [beginStopWatch, setBeginStopWatch] = useState(false);\n\n    // for prototype\n    const [nextHeartRateVal, setNextHeartRateVal] = useState('');\n\n    useEffect(() => {\n        init();\n        grantAudioPerssion();\n\n        return () => {\n            if (_.isFunction(unsubscribeRecord)) unsubscribeRecord();\n            if (_.isFunction(unsubscribePackets)) unsubscribePackets();\n        };\n    }, []);\n\n    useEffect(() => {\n        if (_.isEmpty(record?.beginWorkoutTime)) return;\n\n        const begin = record.beginWorkoutTime;\n        const end = record.finishedWorkoutTime;\n\n        if (_.isNotEmpty(begin)) setBeginStopWatch(true);\n        if (_.isNotEmpty(end)) setBeginStopWatch(false);\n    }, [record]);\n\n    useEffect(() => {\n        if (_.isEmpty(record)) return;\n        if (!isInitRecordDone || !isInitPacketsDone) return;\n\n        evaluateCurrPacket(packets[packets.length - 1]);\n    }, [packets]);\n\n    const init = async () => {\n        checkIntegrity();\n        listenRecordChange();\n        listenPacketsChange();\n    };\n\n    const grantAudioPerssion = () => {\n        Modal.info({\n            title: '提示：監控過程會產生提示聲響，請確保聲音打開！',\n            // content: <button onClick={getAudioPermission}>點我測試;</button>,\n            onOk() {\n                getAudioPermission();\n            },\n            maskClosable: false,\n        });\n    };\n\n    const formatBeginWorkoutTime = () => {\n        if (_.isEmpty(record.beginWorkoutTime)) {\n            return '';\n        }\n\n        return moment(record.beginWorkoutTime).format('YYYY/MM/DD HH:mm');\n    };\n\n    const checkIntegrity = async () => {\n        const recordRef = doc(recordsRef, params.recordId);\n        const recordSnapshot = await getDoc(recordRef);\n        const recordData = recordSnapshot.data();\n        // check if a valid record\n        if (recordData.finishedWorkoutTime != null) {\n            alert('此筆紀錄已完成，將自動導回首頁！');\n            navigate(ROUTE_PATH.admin_dashbaord);\n        }\n\n        // user\n        const userRef = doc(usersRef, recordData.user);\n        const userSnapshot = await getDoc(userRef);\n        const user = userSnapshot.data();\n\n        // difficulty\n        const difficultyRef = doc(difficultiesRef, recordData.difficulty);\n        const diffSnapshot = await getDoc(difficultyRef);\n        const difficulty = diffSnapshot.data();\n\n        setUser(user);\n        setDifficulty(difficulty);\n    };\n\n    const listenRecordChange = async () => {\n        const recordRef = doc(recordsRef, params.recordId);\n        unsubscribeRecord = onSnapshot(recordRef, async (recordSnapshot) => {\n            const recordData = recordSnapshot.data();\n            const record = {\n                ...recordData,\n                beginWorkoutTime: recordData.beginWorkoutTime?.toDate(),\n            };\n\n            setRecord(record);\n            setIsInitRecordDone(true);\n        });\n    };\n\n    const listenPacketsChange = () => {\n        const packetsRef = collection(recordsRef, params.recordId, 'packets');\n\n        unsubscribePackets = onSnapshot(packetsRef, (querySnapshot) => {\n            if (querySnapshot.empty) {\n                alert('監測數據有誤，請重新配對，即將退回選擇畫面！');\n                navigate(ROUTE_PATH.prepare_workout, { replace: true });\n                return;\n            }\n            const newPackets = [];\n            querySnapshot.forEach((doc) => {\n                newPackets.push({\n                    ...doc.data(),\n                    timeLabel: formatWithMoment(doc.data().time),\n                });\n            });\n\n            newPackets.sort((a, b) => a.time - b.time);\n            newPackets.splice(0, 1);\n\n            setPackets(newPackets);\n            setIsInitPacketsDone(true);\n        });\n    };\n\n    const evaluateCurrPacket = (packet) => {\n        const targetHeartRate = record.targetHeartRate;\n        const [overSlight, overMedium, overHigh] = getExactThresholdValue();\n\n        console.log(packet);\n\n        if (packet.heartRate >= overHigh) {\n            console.log('playing: high warn');\n            playWarnSound(WARN.High);\n            sendNotification(WARN.High, packet.heartRate);\n        } else if (\n            packet.heartRate < overHigh &&\n            packet.heartRate >= overMedium\n        ) {\n            console.log('playing: medium warn');\n            playWarnSound(WARN.Medium);\n            sendNotification(WARN.Medium, packet.heartRate);\n        } else if (\n            packet.heartRate < overMedium &&\n            packet.heartRate >= overSlight\n        ) {\n            console.log('playing: slight warn');\n            playWarnSound(WARN.Slight);\n            sendNotification(WARN.Slight, packet.heartRate);\n        } else if (\n            packet.heartRate >= targetHeartRate &&\n            packet.heartRate < overSlight\n        ) {\n            console.log('playing: archieved');\n            playOtherSound(OTHER_SOUND.Archieved);\n            sendNotification('Archieved', packet.heartRate, targetHeartRate);\n        }\n    };\n\n    const getExactThresholdValue = () => {\n        const upperLimitHeartRate = record.upperLimitHeartRate;\n\n        const calBase = upperLimitHeartRate / 100;\n        const overHigh = Math.ceil(calBase * WARN_THRESHOLD.High);\n        const overMedium = Math.ceil(calBase * WARN_THRESHOLD.Medium);\n        const overSlight = Math.ceil(calBase * WARN_THRESHOLD.Slight);\n\n        return [overSlight, overMedium, overHigh];\n    };\n\n    // for prototype testing\n    const addRpmAndHeartRate = async () => {\n        // set the begin time\n        const recordRef = doc(recordsRef, params.recordId);\n        const recordSnapshot = await getDoc(recordRef);\n        const record = recordSnapshot.data();\n        if (record.beginWorkoutTime == null) {\n            await updateDoc(recordRef, {\n                beginWorkoutTime: Timestamp.now(),\n            });\n        }\n\n        const packetsRef = collection(recordsRef, params.recordId, 'packets');\n\n        const time = (packets.length + 1) * 5;\n        const heartRate = _.isNotEmpty(nextHeartRateVal)\n            ? parseInt(nextHeartRateVal)\n            : 95 + packets.length;\n\n        // simulate incoming rpm & heart rate\n        const rpm = 30;\n        const nextPacket = {\n            time,\n            rpm: rpm + packets.length,\n            heartRate: heartRate,\n        };\n\n        await addDoc(packetsRef, nextPacket);\n    };\n\n    const confirmFinish = () => {\n        Modal.confirm({\n            title: '即將結束！',\n            icon: <ExclamationCircleOutlined />,\n            content: '確定結束本次騎乘？',\n            onOk: () => goFinishWorkout(),\n        });\n    };\n\n    const goFinishWorkout = async () => {\n        setBeginStopWatch(false);\n\n        await wait(2000);\n        const recordRef = doc(recordsRef, params.recordId);\n        await updateDoc(recordRef, {\n            finishedWorkoutTime: Timestamp.now(),\n            pairId: null,\n        });\n\n        message.success({ content: '已結束！自動跳轉至統計畫面' });\n\n        await wait(1000);\n        navigate(`${ROUTE_PATH.finsished_workout}/${params.recordId}`, {\n            replace: true,\n        });\n    };\n\n    const getStopWatchInitialValue = () => {\n        if (_.isEmpty(record?.beginWorkoutTime)) {\n            return 0;\n        }\n\n        const begin = moment(record.beginWorkoutTime);\n        const now = moment();\n        const accumlated = moment.duration(now.diff(begin)).asMilliseconds();\n\n        return accumlated;\n    };\n\n    // 右上角通知顯示\n    const sendNotification = (warn, heartRate, targetHeartRate) => {\n        if (warn === WARN.High) {\n            // high warn\n            notification.warn({\n                message: '第三階段警示，請檢查騎乘者身體狀況',\n                description: `達到第三階段警示心率。最新心率：${heartRate} BPM。`,\n            });\n        } else if (warn === WARN.Medium) {\n            // medium warn\n            notification.info({\n                message: '第二階段警示，請留意騎乘者身體狀況',\n                description: `達到第一階段警示心率。最新心率：${heartRate} BPM。`,\n            });\n        } else if (warn === WARN.Slight) {\n            // slight warn\n            notification.open({\n                message: '第一階段警示',\n                description: `達到第一階段警示心率。最新心率：${heartRate} BPM。`,\n                icon: <SmileOutlined style={{ color: '#108ee9' }} />,\n            });\n        } else {\n            // archived\n            notification.success({\n                message: '恭喜達到目標訓練心率！',\n                description: `達到目標訓練心率（${targetHeartRate} BPM）。最新心率：${heartRate} BPM。`,\n            });\n        }\n    };\n\n    if (!isInitRecordDone || !isInitPacketsDone || _.isEmpty(difficulty)) {\n        return <div className={styles.container}>監控畫面初始化中...</div>;\n    }\n\n    const popoverContent = (\n        <>\n            <Input.Search\n                placeholder=\"下個心率是？\"\n                allowClear\n                enterButton=\"新增\"\n                size=\"Large\"\n                onChange={(e) => setNextHeartRateVal(e.target.value)}\n                onSearch={addRpmAndHeartRate}\n            />\n            <Button onClick={confirmFinish}>結束騎乘</Button>\n        </>\n    );\n\n    console.log(record.targetHeartRate);\n\n    // TODO:\n    // refactoring <table> to component\n    return (\n        <div className={styles.container}>\n            <div className={styles.glass}>\n                {/* <h1>騎乘監控畫面</h1> */}\n                <div className={`${styles.col} ${styles.col1}`}>\n                    <span>騎乘者：{user?.name}</span>\n                    <span>騎乘者身體年齡：{user?.age}</span>\n                </div>\n                <div className={`${styles.col} ${styles.col2}`}>\n                    <div className={styles.stopWatchWrapper}>\n                        <span>騎乘進行了：</span>\n                        <StopWatch\n                            start={beginStopWatch}\n                            initialValue={getStopWatchInitialValue()}\n                        />\n                    </div>\n                    <caption>(開始於 {formatBeginWorkoutTime()})</caption>\n                </div>\n                <div className={`${styles.col} ${styles.col3}`}>\n                    平均速率／心率\n                </div>\n                <div className={`${styles.col} ${styles.difficulty}`}>\n                    <Popover\n                        content={popoverContent}\n                        placement=\"bottomRight\"\n                        title=\"更多操作\"\n                        trigger=\"click\"\n                    >\n                        <SettingOutlined width={'1em'} />\n                    </Popover>\n                    <span>騎乘關卡：{difficulty.name}</span>\n                    <span>目標心率：{difficulty.targetHeartRate}</span>\n                    <span>上限心率：{difficulty.upperLimitHeartRate}</span>\n                    <caption>\n                        分階警示心率：{getExactThresholdValue()[0]}/\n                        {getExactThresholdValue()[1]}/\n                        {getExactThresholdValue()[2]}\n                    </caption>\n                </div>\n                <div className={styles.mainCol}>\n                    <LineChart\n                        {...configLineChart(packets, record.targetHeartRate)}\n                    />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default MonitoringWorkout;\n","/* eslint-disable react/display-name */\n/* eslint-disable no-unused-vars */\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n    getDocs,\n    updateDoc,\n    doc,\n    addDoc,\n    query,\n    where,\n} from 'firebase/firestore';\nimport {\n    Layout,\n    Form,\n    PageHeader,\n    Input,\n    Button,\n    message,\n    Modal,\n    Row,\n    Col,\n    Table,\n    Space,\n    Descriptions,\n    InputNumber,\n    Popover,\n} from 'antd';\nimport {\n    PlusOutlined,\n    MoreOutlined,\n    SearchOutlined,\n    CloseCircleFilled,\n    ExclamationCircleOutlined,\n} from '@ant-design/icons';\n\nimport { ROUTE_PATH } from '../../constants';\nimport styles from './styles.module.scss';\n\nimport { usersRef } from '../../services/firebase';\n\nconst { Content } = Layout;\n\nconst UserList = () => {\n    const navigate = useNavigate();\n    const [users, setUsers] = useState([]); // 全部使用者資料\n    const [filteredUser, setFilteredUser] = useState([]); // 過濾的使用者資料\n    const searchBarRef = useRef();\n    const [isDone, setIsDone] = useState(false);\n\n    const [currUser, setCurrUser] = useState(); // used by: edit, view\n    const [loading, setLoading] = useState(false); // Modal 中的 [OK] 按鈕 loading\n\n    // forms\n    const [searchForm] = Form.useForm();\n    const [editForm] = Form.useForm();\n    const [createForm] = Form.useForm();\n\n    // modals\n    const [createModalVisible, setCreateModalVisible] = useState();\n    const [viewModalVisible, setViewModalVisible] = useState(false);\n    const [editModalVisible, setEditModalVisible] = useState(false);\n\n    useEffect(() => {\n        init();\n    }, []);\n\n    const init = async () => {\n        await fetchUsers();\n        setIsDone(true);\n    };\n\n    const fetchUsers = async () => {\n        const q = query(usersRef, where('isDeleted', '!=', true));\n\n        const users = [];\n        const querySnapshot = await getDocs(q);\n        querySnapshot.forEach((doc) => {\n            users.push({\n                ...doc.data(),\n                id: doc.id,\n            });\n        });\n\n        setUsers(users);\n        setFilteredUser(users);\n    };\n\n    const onSearch = async () => {\n        const values = await searchForm.validateFields();\n        const filteredUser = users.filter((u) => u.name.includes(values.name));\n\n        searchBarRef.current.blur();\n\n        setFilteredUser(filteredUser);\n    };\n\n    const onCreateUser = async () => {\n        try {\n            const values = await createForm.validateFields();\n\n            setLoading(true);\n            await addDoc(usersRef, {\n                name: values.name,\n                age: values.age,\n                note: values.note ?? null,\n                isDeleted: false,\n            });\n\n            await fetchUsers();\n            setLoading(false);\n            closeAllModals();\n            createForm.resetFields();\n\n            message.success(`成功新增騎乘者！`);\n        } catch (e) {\n            console.log(e);\n            setLoading(false);\n            message.error(e?.message);\n        }\n    };\n\n    const onPatchUser = async () => {\n        try {\n            const values = await editForm.validateFields();\n            // if pass\n            // [values] would be: {age: 12}\n\n            setLoading(true);\n            const currUserRef = doc(usersRef, currUser.id);\n            await updateDoc(currUserRef, {\n                age: values.age,\n                note: values.note,\n            });\n\n            await fetchUsers();\n            setLoading(false);\n            closeAllModals();\n\n            message.success(`成功更新騎乘者！`);\n        } catch (e) {\n            console.log(e);\n            setLoading(false);\n        }\n    };\n\n    const onDeleteUser = (id) => {\n        const theUser = users.find((u) => u.id === id);\n\n        Modal.confirm({\n            title: `確定要刪除騎乘者者：${theUser.name}`,\n            icon: <ExclamationCircleOutlined />,\n            content: '刪除後，騎乘者資料將無法返回。',\n            okText: '刪除',\n            okType: 'danger',\n            cancelText: '取消',\n            onOk: () => deleteUser(id),\n        });\n    };\n\n    const deleteUser = async (id) => {\n        const theUserRef = doc(usersRef, id);\n        await updateDoc(theUserRef, {\n            isDeleted: true,\n        });\n\n        await fetchUsers();\n\n        message.info('使用者已刪除。');\n    };\n\n    const onViewCurrUserRecord = () => {\n        navigate(`${ROUTE_PATH.record_list}/${currUser.id}`);\n    };\n\n    const openViewModal = (id) => {\n        const currUser = users.find((u) => u.id === id);\n        setCurrUser(currUser);\n        setViewModalVisible(true);\n    };\n\n    const openEditModal = (id) => {\n        const currUser = users.find((u) => u.id === id);\n\n        editForm.setFieldsValue({\n            age: currUser.age,\n            name: currUser.name,\n            note: currUser.note,\n        });\n\n        setCurrUser(currUser);\n        setEditModalVisible(true);\n    };\n\n    const openCreateModal = () => {\n        setCreateModalVisible(true);\n    };\n\n    const closeAllModals = () => {\n        setViewModalVisible(false);\n        setCreateModalVisible(false);\n        setEditModalVisible(false);\n    };\n\n    const closeViewModal = () => {\n        setCurrUser();\n        closeAllModals();\n    };\n\n    const closeCreateModal = () => {\n        createForm.resetFields();\n        closeAllModals();\n    };\n\n    const closeEditModal = () => {\n        setCurrUser();\n        closeAllModals();\n    };\n\n    const goDashboard = () => {\n        navigate(ROUTE_PATH.admin_dashbaord);\n    };\n\n    if (!isDone) {\n        return (\n            <Layout style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        className={styles.PageHeader}\n                        title=\"資料讀取中...\"\n                    />\n                </div>\n            </Layout>\n        );\n    }\n\n    return (\n        <Layout>\n            <Content className=\"site-layout\" style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        title=\"騎乘者資訊列表\"\n                        subTitle=\"管理騎乘者資訊\"\n                        onBack={goDashboard}\n                        extra={[\n                            <Button\n                                key={1}\n                                type=\"primary\"\n                                icon={<PlusOutlined />}\n                                onClick={openCreateModal}\n                            >\n                                新增騎乘者\n                            </Button>,\n                        ]}\n                    />\n                    <Form\n                        {...formLayout}\n                        form={searchForm}\n                        style={{ marginTop: 36 }}\n                    >\n                        <Row gutter={[16, 0]}>\n                            <Col span={16}>\n                                <Form.Item label=\"騎乘者名稱\" name=\"name\">\n                                    <Input\n                                        placeholder=\"輸入騎乘者名稱查詢\"\n                                        allowClear={{\n                                            clearIcon: (\n                                                <CloseCircleFilled\n                                                    onClick={onSearch}\n                                                    style={{\n                                                        color: '#00000040',\n                                                    }}\n                                                />\n                                            ),\n                                        }}\n                                        ref={searchBarRef}\n                                    />\n                                </Form.Item>\n                            </Col>\n                            <Col span={4}>\n                                <Form.Item>\n                                    <Button\n                                        type=\"primary\"\n                                        htmlType=\"submit\"\n                                        onClick={onSearch}\n                                        icon={<SearchOutlined />}\n                                    >\n                                        查詢\n                                    </Button>\n                                </Form.Item>\n                            </Col>\n                        </Row>\n                    </Form>\n                    <Table\n                        columns={columns(\n                            openViewModal,\n                            openEditModal,\n                            onDeleteUser,\n                        )}\n                        dataSource={filteredUser}\n                        pagination={{ pageSize: 5 }}\n                        style={{ marginLeft: 24, marginRight: 24 }}\n                    />\n                    <Modal\n                        title=\"檢視騎乘者\"\n                        visible={viewModalVisible}\n                        onCancel={closeViewModal}\n                        footer={null} // no [Ok], [Cancel] button\n                    >\n                        <Descriptions\n                            bordered\n                            className={styles.descriptions}\n                            size=\"middle\"\n                        >\n                            <Descriptions.Item label=\"騎乘者姓名\" span={3}>\n                                {currUser?.name}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"騎乘者身體年齡\" span={3}>\n                                {currUser?.age}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"備註\" span={3}>\n                                {currUser?.note}\n                            </Descriptions.Item>\n                        </Descriptions>\n                        <Button\n                            type=\"primary\"\n                            onClick={onViewCurrUserRecord}\n                            style={{ marginLeft: '24px' }}\n                        >\n                            查看 {currUser?.name} 騎乘紀錄\n                        </Button>\n                    </Modal>\n                    {/* 新增 Modal */}\n                    <Modal\n                        title=\"新增騎乘者\"\n                        visible={createModalVisible}\n                        onOk={onCreateUser}\n                        confirmLoading={loading}\n                        onCancel={closeCreateModal}\n                        destroyOnClose\n                    >\n                        <Form\n                            {...modalFormLayout}\n                            form={createForm}\n                            layout=\"horizontal\"\n                        >\n                            <Form.Item\n                                label=\"騎乘者姓名\"\n                                name=\"name\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填上騎乘者姓名',\n                                    },\n                                ]}\n                            >\n                                <Input placeholder=\"\" />\n                            </Form.Item>\n                            <Form.Item\n                                label=\"騎乘者身體年齡\"\n                                name=\"age\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填上騎乘者身體年齡',\n                                    },\n                                ]}\n                            >\n                                <InputNumber\n                                    min={1}\n                                    max={99}\n                                    addonAfter={'歲'}\n                                />\n                            </Form.Item>\n                            <Form.Item label=\"備註\" name=\"note\">\n                                <Input.TextArea\n                                    showCount\n                                    placeholder=\"是否有隱疾、其他需留意之處．．．\"\n                                    maxLength={50}\n                                    autoSize={{ minRows: 3, maxRows: 5 }}\n                                />\n                            </Form.Item>\n                        </Form>\n                    </Modal>\n                    <Modal\n                        title=\"編輯騎乘者\"\n                        visible={editModalVisible}\n                        onOk={onPatchUser}\n                        confirmLoading={loading}\n                        onCancel={closeEditModal}\n                        destroyOnClose\n                    >\n                        <Form\n                            {...modalFormLayout}\n                            form={editForm}\n                            layout=\"horizontal\"\n                        >\n                            <Form.Item label=\"騎乘者姓名\">\n                                {currUser?.name}\n                            </Form.Item>\n                            <Form.Item\n                                label=\"騎乘者身體年齡\"\n                                name=\"age\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填上騎乘者身體年齡',\n                                    },\n                                ]}\n                            >\n                                <InputNumber\n                                    min={1}\n                                    max={99}\n                                    addonAfter={'歲'}\n                                />\n                            </Form.Item>\n                            <Form.Item label=\"備註\" name=\"note\">\n                                <Input.TextArea\n                                    showCount\n                                    placeholder=\"是否有隱疾、其他需留意之處．．．\"\n                                    maxLength={50}\n                                    autoSize={{ minRows: 3, maxRows: 5 }}\n                                />\n                            </Form.Item>\n                        </Form>\n                    </Modal>\n                </div>\n            </Content>\n        </Layout>\n    );\n};\n\nconst columns = (openViewModal, openEditModal, onDeleteUser) => [\n    {\n        key: 'name',\n        title: '騎乘者名稱',\n        dataIndex: 'name',\n    },\n    {\n        key: 'age',\n        title: '騎乘者年齡',\n        dataIndex: 'age',\n        sorter: {\n            compare: (a, b) => a.age - b.age,\n        },\n        width: 200,\n    },\n    {\n        key: 'id',\n        title: ' ',\n        dataIndex: 'id',\n        align: 'center',\n        render: (id) => {\n            return (\n                <Popover\n                    content={\n                        <Space direction=\"vertical\" size=\"small\">\n                            <Button\n                                type=\"link\"\n                                onClick={() => openViewModal(id)}\n                            >\n                                查看\n                            </Button>\n                            <Button\n                                type=\"link\"\n                                onClick={() => openEditModal(id)}\n                            >\n                                編輯\n                            </Button>\n                            <Button\n                                type=\"link\"\n                                danger\n                                onClick={() => onDeleteUser(id)}\n                            >\n                                刪除\n                            </Button>\n                        </Space>\n                    }\n                    trigger=\"click\"\n                    placement=\"left\"\n                >\n                    <MoreOutlined rotate={90} style={{ fontSize: '20px' }} />\n                </Popover>\n            );\n        },\n        width: 150,\n    },\n];\n\nconst formLayout = {\n    labelCol: {\n        // span: 8,\n        offset: 10,\n    },\n    wrapperCol: {\n        span: 16,\n    },\n};\n\nconst modalFormLayout = {\n    labelCol: {\n        span: 6,\n        offset: 2,\n    },\n    wrapperCol: {\n        span: 14,\n    },\n};\n\nexport default UserList;\n","/* eslint-disable react/display-name */\n/* eslint-disable no-unused-vars */\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n    getDocs,\n    updateDoc,\n    doc,\n    addDoc,\n    query,\n    where,\n} from 'firebase/firestore';\nimport {\n    Layout,\n    Form,\n    PageHeader,\n    Input,\n    Button,\n    message,\n    Modal,\n    Row,\n    Col,\n    Table,\n    Space,\n    Descriptions,\n    InputNumber,\n    Popover,\n    Badge,\n    Typography,\n} from 'antd';\nimport {\n    PlusOutlined,\n    MoreOutlined,\n    SearchOutlined,\n    CloseCircleFilled,\n    ExclamationCircleOutlined,\n} from '@ant-design/icons';\n\nimport { ROUTE_PATH, WARN_THRESHOLD, WARN } from '../../constants';\nimport styles from './styles.module.scss';\nimport _ from '../../util/helper';\n\nimport { difficultiesRef } from '../../services/firebase';\n\nconst { Content } = Layout;\nconst { Text } = Typography;\n\nconst DifficulityList = () => {\n    const navigate = useNavigate();\n    const [difficulties, setDifficulties] = useState([]); // 全部難度\n    const [filteredDiffs, setFilteredDiffs] = useState([]); // 過濾難度\n    const searchBarRef = useRef();\n    const [isDone, setIsDone] = useState(false);\n\n    const [currDiff, setCurrDiff] = useState(); // used by: edit, view\n    const [loading, setLoading] = useState(false); // Modal 中的 [OK] 按鈕 loading\n\n    // 顯示各階段警示心率的值\n    const [warnHRValues, setWarnHRValues] = useState([]);\n\n    // forms\n    const [searchForm] = Form.useForm();\n    const [editForm] = Form.useForm();\n    const [createForm] = Form.useForm();\n\n    // forms changed\n    // 監聽上限數值變化，返回三階段警示心率\n    const [createFormChange, setCreateFormChange] = useState();\n    const [editFormChange, setEditFormChange] = useState();\n\n    // modals\n    const [createModalVisible, setCreateModalVisible] = useState();\n    const [viewModalVisible, setViewModalVisible] = useState(false);\n    const [editModalVisible, setEditModalVisible] = useState(false);\n\n    useEffect(() => {\n        init();\n    }, []);\n\n    const init = async () => {\n        await fetchDiffs();\n        setIsDone(true);\n    };\n\n    const fetchDiffs = async () => {\n        const q = query(difficultiesRef, where('isDeleted', '!=', true));\n\n        const difficulties = [];\n        const querySnapshot = await getDocs(q);\n        querySnapshot.forEach((doc) => {\n            difficulties.push({\n                ...doc.data(),\n                id: doc.id,\n            });\n        });\n\n        setDifficulties(difficulties);\n        setFilteredDiffs(difficulties);\n    };\n\n    const onSearch = async () => {\n        const values = await searchForm.validateFields();\n        const filteredDiffs = difficulties.filter((d) =>\n            d.name.includes(values.name),\n        );\n\n        searchBarRef.current.blur();\n\n        setFilteredDiffs(filteredDiffs);\n    };\n\n    const onCreateDiff = async () => {\n        try {\n            const values = await createForm.validateFields();\n\n            setLoading(true);\n            await addDoc(difficultiesRef, {\n                name: values.name,\n                targetHeartRate: values.targetHeartRate,\n                targetWorkoutTime: values.targetWorkoutTime,\n                upperLimitHeartRate: values.upperLimitHeartRate,\n                note: values.note ?? null,\n                isDeleted: false,\n            });\n\n            await fetchDiffs();\n            setLoading(false);\n            closeAllModals();\n            createForm.resetFields();\n\n            message.success(`成功新增難度！`);\n        } catch (e) {\n            console.log(e);\n            setLoading(false);\n        }\n    };\n\n    const onPatchDiff = async () => {\n        try {\n            const values = await editForm.validateFields();\n            // if pass\n            // [values] would be: {age: 12}\n\n            setLoading(true);\n            const currUserRef = doc(difficultiesRef, currDiff.id);\n            await updateDoc(currUserRef, {\n                // 名字不更新\n                targetHeartRate: values.targetHeartRate,\n                targetWorkoutTime: values.targetWorkoutTime,\n                upperLimitHeartRate: values.upperLimitHeartRate,\n                note: values.note,\n            });\n\n            await fetchDiffs();\n            setLoading(false);\n            closeAllModals();\n\n            message.success(`成功更新難度！`);\n        } catch (e) {\n            console.log(e);\n        }\n    };\n\n    const onDeleteDiff = (id) => {\n        const theDiff = difficulties.find((d) => d.id === id);\n\n        Modal.confirm({\n            title: `確定要刪除難度：${theDiff.name}`,\n            icon: <ExclamationCircleOutlined />,\n            content: '刪除後，難度資料將無法返回。',\n            okText: '刪除',\n            okType: 'danger',\n            cancelText: '取消',\n            onOk: () => deleteDiff(id),\n        });\n    };\n\n    const deleteDiff = async (id) => {\n        const theDiffRef = doc(difficultiesRef, id);\n        await updateDoc(theDiffRef, {\n            isDeleted: true,\n        });\n\n        await fetchDiffs();\n\n        message.info('難度已刪除。');\n    };\n\n    const openViewModal = (id) => {\n        const currDiff = difficulties.find((d) => d.id === id);\n        const warnHRValues = getExactThresholdValue(\n            currDiff.upperLimitHeartRate,\n        );\n\n        setCurrDiff(currDiff);\n        setWarnHRValues(warnHRValues);\n        setViewModalVisible(true);\n    };\n\n    const openEditModal = (id) => {\n        const currDiff = difficulties.find((d) => d.id === id);\n\n        editForm.setFieldsValue({\n            targetHeartRate: currDiff.targetHeartRate,\n            targetWorkoutTime: currDiff.targetWorkoutTime,\n            upperLimitHeartRate: currDiff.upperLimitHeartRate,\n            note: currDiff.note,\n        });\n\n        setCurrDiff(currDiff);\n        setEditFormChange(currDiff);\n        setEditModalVisible(true);\n    };\n\n    const openCreateModal = () => {\n        setCreateModalVisible(true);\n    };\n\n    const closeAllModals = () => {\n        setViewModalVisible(false);\n        setCreateModalVisible(false);\n        setEditModalVisible(false);\n    };\n\n    const closeViewModal = () => {\n        setCurrDiff();\n        closeAllModals();\n    };\n\n    const closeCreateModal = () => {\n        createForm.resetFields();\n        setCreateFormChange();\n        closeAllModals();\n    };\n\n    const closeEditModal = () => {\n        setCurrDiff();\n        setEditFormChange();\n        closeAllModals();\n    };\n\n    const onFormValueChange = (changedVal, allVal, formKey) => {\n        if (formKey === 'create') setCreateFormChange(allVal);\n        if (formKey === 'edit') setEditFormChange(allVal);\n    };\n\n    const goDashboard = () => {\n        navigate(ROUTE_PATH.admin_dashbaord);\n    };\n\n    const getExactThresholdValue = (upperLimitHeartRate) => {\n        if (!_.isNumber(upperLimitHeartRate)) {\n            return;\n        }\n\n        const calBase = upperLimitHeartRate / 100;\n\n        const overHigh = Math.ceil(calBase * WARN_THRESHOLD.High);\n        const overMedium = Math.ceil(calBase * WARN_THRESHOLD.Medium);\n        const overSlight = Math.ceil(calBase * WARN_THRESHOLD.Slight);\n\n        return [overSlight, overMedium, overHigh];\n    };\n\n    if (!isDone) {\n        return (\n            <Layout style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        className={styles.PageHeader}\n                        title=\"資料讀取中...\"\n                    />\n                </div>\n            </Layout>\n        );\n    }\n\n    return (\n        <Layout>\n            <Content className=\"site-layout\" style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        title=\"訓練難度資訊列表\"\n                        subTitle=\"管理難度資訊\"\n                        onBack={goDashboard}\n                        extra={[\n                            <Button\n                                key={1}\n                                type=\"primary\"\n                                icon={<PlusOutlined />}\n                                onClick={openCreateModal}\n                            >\n                                新增難度\n                            </Button>,\n                        ]}\n                    />\n                    <Form\n                        {...formLayout}\n                        form={searchForm}\n                        style={{ marginTop: 36 }}\n                    >\n                        <Row gutter={[16, 0]}>\n                            <Col span={16}>\n                                <Form.Item label=\"難度名稱\" name=\"name\">\n                                    <Input\n                                        placeholder=\"輸入難度名稱查詢\"\n                                        allowClear={{\n                                            clearIcon: (\n                                                <CloseCircleFilled\n                                                    onClick={onSearch}\n                                                    style={{\n                                                        color: '#00000040',\n                                                    }}\n                                                />\n                                            ),\n                                        }}\n                                        ref={searchBarRef}\n                                    />\n                                </Form.Item>\n                            </Col>\n                            <Col span={4}>\n                                <Form.Item>\n                                    <Button\n                                        type=\"primary\"\n                                        htmlType=\"submit\"\n                                        onClick={onSearch}\n                                        icon={<SearchOutlined />}\n                                    >\n                                        查詢\n                                    </Button>\n                                </Form.Item>\n                            </Col>\n                        </Row>\n                    </Form>\n                    <Table\n                        columns={columns(\n                            openViewModal,\n                            openEditModal,\n                            onDeleteDiff,\n                        )}\n                        dataSource={filteredDiffs}\n                        pagination={{ pageSize: 5 }}\n                        style={{ marginLeft: 24, marginRight: 24 }}\n                    />\n                    <Modal\n                        title=\"檢視難度\"\n                        visible={viewModalVisible}\n                        onCancel={closeViewModal}\n                        footer={null} // no [Ok], [Cancel] button\n                        width={600}\n                    >\n                        <Descriptions\n                            bordered\n                            className={styles.descriptions}\n                            size=\"middle\"\n                            column={2}\n                        >\n                            <Descriptions.Item label=\"難度名稱\" span={1}>\n                                {currDiff?.name}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"目標騎乘時間\" span={1}>\n                                {currDiff?.targetWorkoutTime} 分\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"目標心率數值\" span={2}>\n                                {currDiff?.targetHeartRate}\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"上限心率數值\" span={2}>\n                                {currDiff?.upperLimitHeartRate}\n                            </Descriptions.Item>\n                            <Descriptions.Item\n                                label={\n                                    <>\n                                        警示心率門檻\n                                        <br />\n                                        <Text\n                                            type=\"secondary\"\n                                            style={{ fontSize: '0.8em' }}\n                                        >\n                                            依據上限心率數值計算\n                                        </Text>\n                                    </>\n                                }\n                                span={2}\n                            >\n                                <Badge\n                                    color=\"blue\"\n                                    text={WarnHRValueDisplay(\n                                        warnHRValues?.[0],\n                                        WARN.Slight,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n\n                                <Badge\n                                    color=\"gold\"\n                                    text={WarnHRValueDisplay(\n                                        warnHRValues?.[1],\n                                        WARN.Medium,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n\n                                <Badge\n                                    color=\"volcano\"\n                                    text={WarnHRValueDisplay(\n                                        warnHRValues?.[2],\n                                        WARN.High,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n                            </Descriptions.Item>\n                            <Descriptions.Item label=\"備註\" span={2}>\n                                {currDiff?.note}\n                            </Descriptions.Item>\n                        </Descriptions>\n                    </Modal>\n                    {/* 新增 Modal */}\n                    <Modal\n                        title=\"新增難度\"\n                        visible={createModalVisible}\n                        onOk={onCreateDiff}\n                        confirmLoading={loading}\n                        onCancel={closeCreateModal}\n                        destroyOnClose\n                    >\n                        <Form\n                            {...modalFormLayout}\n                            form={createForm}\n                            layout=\"horizontal\"\n                            onValuesChange={(changedVal, allVal) =>\n                                onFormValueChange(changedVal, allVal, 'create')\n                            }\n                        >\n                            <Form.Item\n                                label=\"難度名稱\"\n                                name=\"name\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填難度名稱',\n                                    },\n                                ]}\n                            >\n                                <Input placeholder=\"\" />\n                            </Form.Item>\n                            <Form.Item\n                                label=\"目標騎乘時間\"\n                                name=\"targetWorkoutTime\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填目標騎乘時間',\n                                    },\n                                ]}\n                            >\n                                <InputNumber\n                                    min={1}\n                                    max={200}\n                                    addonAfter={'分'}\n                                />\n                            </Form.Item>\n                            <Form.Item\n                                label=\"目標心率數值\"\n                                name=\"targetHeartRate\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填目標心率數值',\n                                    },\n                                ]}\n                            >\n                                <InputNumber\n                                    min={1}\n                                    max={200}\n                                    addonAfter={'BPM'}\n                                />\n                            </Form.Item>\n                            <Form.Item\n                                label=\"上限心率數值\"\n                                name=\"upperLimitHeartRate\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填上限心率數值',\n                                    },\n                                ]}\n                                tooltip=\"此數值用做計算分階警示心率\"\n                            >\n                                <InputNumber\n                                    min={1}\n                                    max={200}\n                                    addonAfter={'BPM'}\n                                />\n                            </Form.Item>\n                            <Form.Item label=\" \" colon={false}>\n                                <Badge\n                                    color=\"blue\"\n                                    text={WarnHRValueDisplay(\n                                        getExactThresholdValue(\n                                            createFormChange?.upperLimitHeartRate,\n                                        )?.[0],\n                                        WARN.Slight,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n\n                                <Badge\n                                    color=\"gold\"\n                                    text={WarnHRValueDisplay(\n                                        getExactThresholdValue(\n                                            createFormChange?.upperLimitHeartRate,\n                                        )?.[1],\n                                        WARN.Medium,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n\n                                <Badge\n                                    color=\"volcano\"\n                                    text={WarnHRValueDisplay(\n                                        getExactThresholdValue(\n                                            createFormChange?.upperLimitHeartRate,\n                                        )?.[2],\n                                        WARN.High,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n                            </Form.Item>\n                            <Form.Item label=\"備註\" name=\"note\">\n                                <Input.TextArea\n                                    showCount\n                                    placeholder=\"需調整阻力值至多少、騎乘時的其他建議．．．\"\n                                    maxLength={50}\n                                    autoSize={{ minRows: 3, maxRows: 5 }}\n                                />\n                            </Form.Item>\n                        </Form>\n                    </Modal>\n                    <Modal\n                        title=\"編輯難度\"\n                        visible={editModalVisible}\n                        onOk={onPatchDiff}\n                        confirmLoading={loading}\n                        onCancel={closeEditModal}\n                        destroyOnClose\n                    >\n                        <Form\n                            {...modalFormLayout}\n                            form={editForm}\n                            layout=\"horizontal\"\n                            onValuesChange={(changedVal, allVal) =>\n                                onFormValueChange(changedVal, allVal, 'edit')\n                            }\n                        >\n                            <Form.Item label=\"難度名稱\">\n                                {currDiff?.name}\n                            </Form.Item>\n                            <Form.Item\n                                label=\"目標騎乘時間\"\n                                name=\"targetWorkoutTime\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填目標騎乘時間',\n                                    },\n                                ]}\n                            >\n                                <InputNumber\n                                    min={1}\n                                    max={200}\n                                    addonAfter={'分'}\n                                />\n                            </Form.Item>\n                            <Form.Item\n                                label=\"目標心率數值\"\n                                name=\"targetHeartRate\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填目標心率數值',\n                                    },\n                                ]}\n                            >\n                                <InputNumber\n                                    min={1}\n                                    max={200}\n                                    addonAfter={'BPM'}\n                                />\n                            </Form.Item>\n                            <Form.Item\n                                label=\"上限心率數值\"\n                                name=\"upperLimitHeartRate\"\n                                rules={[\n                                    {\n                                        required: true,\n                                        message: '請填上限心率數值',\n                                    },\n                                ]}\n                            >\n                                <InputNumber\n                                    min={1}\n                                    max={200}\n                                    addonAfter={'BPM'}\n                                />\n                            </Form.Item>\n                            <Form.Item label=\" \" colon={false}>\n                                <Badge\n                                    color=\"blue\"\n                                    text={WarnHRValueDisplay(\n                                        getExactThresholdValue(\n                                            editFormChange?.upperLimitHeartRate,\n                                        )?.[0],\n                                        WARN.Slight,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n\n                                <Badge\n                                    color=\"gold\"\n                                    text={WarnHRValueDisplay(\n                                        getExactThresholdValue(\n                                            editFormChange?.upperLimitHeartRate,\n                                        )?.[1],\n                                        WARN.Medium,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n\n                                <Badge\n                                    color=\"volcano\"\n                                    text={WarnHRValueDisplay(\n                                        getExactThresholdValue(\n                                            editFormChange?.upperLimitHeartRate,\n                                        )?.[2],\n                                        WARN.High,\n                                    )}\n                                    style={{\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                    }}\n                                />\n                            </Form.Item>\n                            <Form.Item label=\"備註\" name=\"note\">\n                                <Input.TextArea\n                                    showCount\n                                    placeholder=\"需調整阻力值至多少、騎乘時的其他建議．．．\"\n                                    maxLength={50}\n                                    autoSize={{ minRows: 3, maxRows: 5 }}\n                                />\n                            </Form.Item>\n                        </Form>\n                    </Modal>\n                </div>\n            </Content>\n        </Layout>\n    );\n};\n\nconst columns = (openViewModal, openEditModal, onDeleteDiff) => [\n    {\n        key: 'name',\n        title: '難度名稱',\n        dataIndex: 'name',\n    },\n    {\n        key: 'targetWorkoutTime',\n        title: '目標騎乘時間',\n        dataIndex: 'targetWorkoutTime',\n        sorter: {\n            compare: (a, b) => a.targetWorkoutTime - b.targetWorkoutTime,\n        },\n        width: 200,\n    },\n    {\n        key: 'targetHeartRate',\n        title: '目標心率數值',\n        dataIndex: 'targetHeartRate',\n        sorter: {\n            compare: (a, b) => a.targetHeartRate - b.targetHeartRate,\n        },\n        width: 200,\n    },\n    {\n        key: 'upperLimitHeartRate',\n        title: '上限心率數值',\n        dataIndex: 'upperLimitHeartRate',\n        sorter: {\n            compare: (a, b) => a.upperLimitHeartRate - b.upperLimitHeartRate,\n        },\n        width: 200,\n    },\n    {\n        key: 'id',\n        title: ' ',\n        dataIndex: 'id',\n        align: 'center',\n        render: (id) => {\n            return (\n                <Popover\n                    content={\n                        <Space direction=\"vertical\" size=\"small\">\n                            <Button\n                                type=\"link\"\n                                onClick={() => openViewModal(id)}\n                            >\n                                查看\n                            </Button>\n                            <Button\n                                type=\"link\"\n                                onClick={() => openEditModal(id)}\n                            >\n                                編輯\n                            </Button>\n                            <Button\n                                type=\"link\"\n                                danger\n                                onClick={() => onDeleteDiff(id)}\n                            >\n                                刪除\n                            </Button>\n                        </Space>\n                    }\n                    trigger=\"click\"\n                    placement=\"left\"\n                >\n                    <MoreOutlined rotate={90} style={{ fontSize: '20px' }} />\n                </Popover>\n            );\n        },\n        width: 150,\n    },\n];\n\nconst WarnHRValueDisplay = (value, warn) => {\n    let phase;\n    let overVal;\n    if (warn === WARN.Slight) {\n        phase = '一';\n        overVal = WARN_THRESHOLD.Slight - 100;\n    }\n    if (warn === WARN.Medium) {\n        phase = '二';\n        overVal = WARN_THRESHOLD.Medium - 100;\n    }\n    if (warn === WARN.High) {\n        phase = '三';\n        overVal = WARN_THRESHOLD.High - 100;\n    }\n\n    return (\n        <div style={{ display: 'flex' }}>\n            第{phase}階段：{value}\n            <Text type=\"secondary\" style={{ fontSize: '0.85em' }}>\n                （超出 {overVal}％）\n            </Text>\n        </div>\n    );\n};\n\nconst formLayout = {\n    labelCol: {\n        // span: 8,\n        offset: 10,\n    },\n    wrapperCol: {\n        span: 16,\n    },\n};\n\nconst modalFormLayout = {\n    labelCol: {\n        span: 6,\n        offset: 2,\n    },\n    wrapperCol: {\n        span: 14,\n    },\n};\n\nexport default DifficulityList;\n","import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport {\n    collection,\n    doc,\n    getDoc,\n    getDocs,\n    updateDoc,\n} from 'firebase/firestore';\nimport moment from 'moment';\nimport { DualAxes as LineChart } from '@ant-design/plots';\nimport {\n    Layout,\n    Descriptions,\n    PageHeader,\n    Input,\n    Button,\n    message,\n    Modal,\n} from 'antd';\nimport { UserOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\n\nimport { ROUTE_PATH } from '../../constants';\nimport styles from './styles.module.scss';\nimport _ from '../../util/helper';\nimport formatWithMoment from '../../util/formatSeconds';\nimport wait from '../../util/wait';\nimport configLineChart from '../../util/configLineChart';\n\nimport { recordsRef, usersRef, difficultiesRef } from '../../services/firebase';\n\nconst { Content } = Layout;\n\nconst FinishedWorkout = () => {\n    const navigate = useNavigate();\n    const params = useParams();\n\n    const [user, setUser] = useState();\n    const [record, setRecord] = useState();\n    const [packets, setPackets] = useState([]);\n    const [difficulty, setDifficulty] = useState();\n\n    const [isDone, setIsDone] = useState(false);\n\n    // doctor says...\n    const [therapist, setTherapist] = useState();\n    const [comment, setComment] = useState();\n\n    const [inputStatus, setInputStatus] = useState();\n\n    useEffect(() => {\n        init();\n    }, []);\n\n    const init = async () => {\n        const recordRef = doc(recordsRef, params.recordId);\n        const packetsRef = collection(recordsRef, params.recordId, 'packets');\n\n        // record\n        const recordSnapshot = await getDoc(recordRef);\n        const recordData = recordSnapshot.data();\n        if (\n            recordData.pairId != null ||\n            recordData.finishedWorkoutTime == null\n        ) {\n            alert('此筆紀錄尚未完成，將自動導回首頁！');\n            navigate(ROUTE_PATH.admin_dashbaord);\n            return;\n        }\n        const record = {\n            ...recordData,\n            beginWorkoutTime: recordData.beginWorkoutTime.toDate(),\n            finishedWorkoutTime: recordData.finishedWorkoutTime.toDate(),\n        };\n\n        // packets\n        const packets = [];\n        const packetsSnapshot = await getDocs(packetsRef);\n        packetsSnapshot.forEach((doc) => {\n            packets.push({\n                ...doc.data(),\n                timeLabel: formatWithMoment(doc.data().time),\n            });\n        });\n\n        packets.sort((a, b) => a.time - b.time);\n        packets.splice(0, 1);\n\n        // user\n        const userRef = doc(usersRef, recordData.user);\n        const userSnapshot = await getDoc(userRef);\n        const user = userSnapshot.data();\n\n        // difficulty\n        const difficultyRef = doc(difficultiesRef, recordData.difficulty);\n        const diffSnapshot = await getDoc(difficultyRef);\n        const difficulty = diffSnapshot.data();\n\n        // therapist & comment\n        const therapist = record.therapist ?? '';\n        const comment = record.comment ?? '';\n\n        setUser(user);\n        setRecord(record);\n        setPackets(packets);\n        setDifficulty(difficulty);\n        setTherapist(therapist);\n        setComment(comment);\n        setIsDone(true);\n    };\n\n    const onFormSubmit = async (e) => {\n        e.preventDefault();\n        if (_.isEmpty(therapist)) {\n            message.error('請填上治療師名稱');\n            setInputStatus('error');\n            return;\n        }\n\n        Modal.confirm({\n            title: '即將提交！',\n            icon: <ExclamationCircleOutlined />,\n            content: '確定資料填寫無誤？',\n            onOk: () => updateTherapistInfo(),\n        });\n    };\n\n    const updateTherapistInfo = async () => {\n        const recordRef = doc(recordsRef, params.recordId);\n        await updateDoc(recordRef, {\n            therapist: therapist,\n            comment: comment,\n        });\n\n        message.success({ content: '已提交！自動跳轉至選單畫面' });\n\n        await wait(1000);\n        navigate(ROUTE_PATH.admin_dashbaord, { replace: true });\n    };\n\n    const calWorkoutTime = () => {\n        const begin = moment(record.beginWorkoutTime);\n        const end = moment(record.finishedWorkoutTime);\n\n        const diff = moment.duration(end.diff(begin)).asMilliseconds();\n\n        console.log(diff);\n\n        const h = ('0' + Math.floor(diff / 3600000)).slice(-2);\n        const m = ('0' + Math.floor((diff / 60000) % 60)).slice(-2);\n        const s = ('0' + Math.floor((diff / 1000) % 60)).slice(-2);\n\n        let returnStr = '';\n\n        if (h != '00') returnStr += `${h} 小時 `;\n        returnStr += `${m} 分 ${s} 秒`;\n\n        return returnStr;\n    };\n\n    if (!isDone) {\n        return (\n            <Layout style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        className={styles.PageHeader}\n                        title=\"紀錄資料讀取中...\"\n                    />\n                </div>\n            </Layout>\n        );\n    }\n\n    return (\n        <Layout>\n            <Content className=\"site-layout\" style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        className={styles.PageHeader}\n                        title=\"已結束騎乘，本次騎乘數據統計\"\n                        subTitle=\"請至下方填寫資訊\"\n                    />\n\n                    <Descriptions bordered className={styles.descriptions}>\n                        <Descriptions.Item label=\"騎乘者姓名\" span={2}>\n                            {user?.name}\n                        </Descriptions.Item>\n                        <Descriptions.Item label=\"騎乘者身體年齡\">\n                            {user?.age}\n                        </Descriptions.Item>\n\n                        <Descriptions.Item\n                            label={\n                                <div>\n                                    實際騎乘時間\n                                    <br />/ 目標騎乘時間\n                                </div>\n                            }\n                        >\n                            {calWorkoutTime()}／{difficulty.targetWorkoutTime}{' '}\n                            分\n                        </Descriptions.Item>\n                        <Descriptions.Item label=\"開始騎乘時間\">\n                            {record.beginWorkoutTime.toLocaleString()}\n                        </Descriptions.Item>\n                        <Descriptions.Item label=\"結束騎乘時間\">\n                            {record.finishedWorkoutTime.toLocaleString()}\n                        </Descriptions.Item>\n                        <Descriptions.Item label=\"騎乘關卡\">\n                            {difficulty.name}\n                        </Descriptions.Item>\n                        <Descriptions.Item label=\"目標心率\">\n                            {difficulty.targetHeartRate}\n                        </Descriptions.Item>\n                        <Descriptions.Item label=\"上限心率\">\n                            {difficulty.upperLimitHeartRate}\n                        </Descriptions.Item>\n                        <Descriptions.Item label=\"RPM＆心率統計圖\">\n                            <LineChart\n                                {...configLineChart(\n                                    packets,\n                                    record.targetHeartRate,\n                                )}\n                            />\n                        </Descriptions.Item>\n                    </Descriptions>\n\n                    <div className={styles.form}>\n                        <h3>請填寫以下資料，方可返回主選單</h3>\n\n                        <Input\n                            size=\"large\"\n                            placeholder=\"物理治療師名稱\"\n                            prefix={<UserOutlined />}\n                            value={therapist}\n                            onChange={(e) => {\n                                setTherapist(e.target.value);\n                                setInputStatus();\n                            }}\n                            status={inputStatus}\n                        />\n                        <Input.TextArea\n                            showCount\n                            placeholder=\"治療結果評語\"\n                            maxLength={50}\n                            value={comment}\n                            onChange={(e) => setComment(e.target.value)}\n                            style={{ marginTop: 16 }}\n                        />\n\n                        <Button\n                            onClick={onFormSubmit}\n                            type=\"primary\"\n                            style={{ marginTop: 16 }}\n                        >\n                            提交，返回主選單\n                        </Button>\n                    </div>\n                </div>\n            </Content>\n        </Layout>\n    );\n};\n\nexport default FinishedWorkout;\n","/* eslint-disable react/display-name */\n/* eslint-disable no-unused-vars */\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { getDocs, collection } from 'firebase/firestore';\nimport {\n    Layout,\n    Form,\n    PageHeader,\n    Button,\n    Modal,\n    Row,\n    Col,\n    Table,\n    Descriptions,\n    Select,\n} from 'antd';\nimport moment from 'moment';\nimport { DualAxes as LineChart } from '@ant-design/plots';\nimport { SearchOutlined } from '@ant-design/icons';\nimport _ from '../../util/helper';\n\nimport { ROUTE_PATH } from '../../constants';\nimport styles from './styles.module.scss';\n\nimport { recordsRef, usersRef, difficultiesRef } from '../../services/firebase';\nimport formatWithMoment from '../../util/formatSeconds';\nimport configLineChart from '../../util/configLineChart';\n\nconst { Content } = Layout;\nconst { Option } = Select;\n\nconst RecordList = () => {\n    const navigate = useNavigate();\n    const params = useParams();\n\n    const searchBarRef = useRef();\n    const [isDone, setIsDone] = useState(false);\n    const [loading, setLoading] = useState(false); // 等待抓取 packets 資料\n\n    const [records, setReocrds] = useState([]);\n    const [filteredRecords, setFilteredReocrds] = useState([]);\n    const [currRecord, setCurrRecord] = useState();\n    const [currReocrdPackets, setCurrRecordPackets] = useState();\n\n    // patched Data\n    const [users, setUsers] = useState(); // 把使用者資料灌回去 records 中\n    const [difficulties, setDifficulties] = useState([]); // 把難度資料灌回去 records 中\n\n    // forms\n    const [searchForm] = Form.useForm();\n\n    // modals\n    const [viewModalVisible, setViewModalVisible] = useState(false);\n\n    useEffect(() => {\n        init();\n    }, []);\n\n    const init = async () => {\n        const users = await fetchUsers();\n        const records = await fetchRecords();\n        const difficulties = await fetchDiffs();\n\n        patchRecordsWithUserAndDiff({ users, records, difficulties });\n    };\n\n    const fetchUsers = async () => {\n        const users = [];\n        const querySnapshot = await getDocs(usersRef);\n        querySnapshot.forEach((doc) => {\n            if (!doc.data()?.isDeleted) {\n                users.push({\n                    ...doc.data(),\n                    id: doc.id,\n                });\n            }\n        });\n\n        return users;\n    };\n\n    const fetchRecords = async () => {\n        const records = [];\n        const querySnapshot = await getDocs(recordsRef);\n        querySnapshot.forEach((doc) => {\n            const recordData = doc.data();\n            if (\n                recordData.beginWorkoutTime != null &&\n                recordData.finishedWorkoutTime != null\n            ) {\n                records.push({\n                    ...recordData,\n                    id: doc.id,\n                    beginWorkoutTime: recordData.beginWorkoutTime.toDate(),\n                    finishedWorkoutTime: recordData.finishedWorkoutTime.toDate(),\n                });\n            }\n        });\n\n        records.sort(\n            (a, b) =>\n                b.finishedWorkoutTime.getTime() -\n                a.finishedWorkoutTime.getTime(),\n        );\n\n        return records;\n    };\n\n    const fetchDiffs = async () => {\n        const difficulties = [];\n        const querySnapshot = await getDocs(difficultiesRef);\n        querySnapshot.forEach((doc) => {\n            difficulties.push({\n                ...doc.data(),\n                id: doc.id,\n            });\n        });\n\n        return difficulties;\n    };\n\n    const patchRecordsWithUserAndDiff = ({ users, records, difficulties }) => {\n        // patch with key [userData]\n        // patch with key [difficultyData]\n\n        const patchedRecords = records.map((record) => {\n            const userData = users.find((u) => u.id === record.user);\n            const difficultyData = difficulties.find(\n                (d) => d.id === record.difficulty,\n            );\n\n            return {\n                ...record,\n                userData,\n                difficultyData,\n            };\n        });\n\n        setReocrds(patchedRecords);\n        setUsers(users);\n        setDifficulties(difficulties);\n        setIsDone(true);\n\n        if (params.userId !== '123') {\n            const filteredRecords = patchedRecords.filter(\n                (r) => r.user === params.userId,\n            );\n            setFilteredReocrds(filteredRecords);\n            searchForm.setFieldsValue({ user: params.userId });\n        } else {\n            setFilteredReocrds(patchedRecords);\n        }\n    };\n\n    const onSearch = async () => {\n        const values = await searchForm.validateFields();\n\n        let filteredRecords = records.filter((r) => {\n            if (_.isEmpty(values.user) && _.isEmpty(values.difficulty)) {\n                return true;\n            }\n            if (_.isNotEmpty(values.user) && _.isNotEmpty(values.difficulty)) {\n                return (\n                    r.user === values.user && r.difficulty === values.difficulty\n                );\n            }\n            if (_.isNotEmpty(values.user) && _.isEmpty(values.difficulty)) {\n                return r.user === values.user;\n            }\n            if (_.isNotEmpty(values.difficulty) && _.isEmpty(values.user)) {\n                console.log('here');\n                return r.difficulty === values.difficulty;\n            }\n        });\n\n        setFilteredReocrds(filteredRecords);\n    };\n\n    const openViewModal = async (id) => {\n        setViewModalVisible(true);\n        setLoading(true);\n\n        const currRecord = records.find((r) => r.id === id);\n        const packetsRef = collection(recordsRef, id, 'packets');\n\n        // packets\n        const currReocrdPackets = [];\n        const packetsSnapshot = await getDocs(packetsRef);\n        packetsSnapshot.forEach((doc) => {\n            currReocrdPackets.push({\n                ...doc.data(),\n                timeLabel: formatWithMoment(doc.data().time),\n            });\n        });\n\n        currReocrdPackets.sort((a, b) => a.time - b.time);\n        currReocrdPackets.splice(0, 1);\n\n        setCurrRecord(currRecord);\n        setCurrRecordPackets(currReocrdPackets);\n\n        setLoading(false);\n    };\n\n    const closeViewModal = () => {\n        setCurrRecord();\n        setCurrRecordPackets([]);\n        setViewModalVisible(false);\n    };\n\n    const goDashboard = () => {\n        navigate(ROUTE_PATH.admin_dashbaord);\n    };\n\n    if (!isDone) {\n        return (\n            <Layout style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        className={styles.PageHeader}\n                        title=\"資料讀取中...\"\n                    />\n                </div>\n            </Layout>\n        );\n    }\n\n    return (\n        <Layout>\n            <Content className=\"site-layout\" style={{ padding: '24px' }}>\n                <div className={styles.container}>\n                    <PageHeader\n                        title=\"騎乘紀錄列表\"\n                        subTitle=\"查看騎乘紀錄資訊\"\n                        onBack={goDashboard}\n                    />\n                    <Form\n                        {...formLayout}\n                        form={searchForm}\n                        style={{ marginTop: 36 }}\n                    >\n                        <Row gutter={[16, 0]}>\n                            <Col span={10}>\n                                <Form.Item label=\"騎乘者名稱\" name=\"user\">\n                                    <Select placeholder=\"選擇騎乘者\" allowClear>\n                                        {users.map((user) => (\n                                            <Option\n                                                value={user.id}\n                                                key={user.id}\n                                            >\n                                                {user.name}\n                                            </Option>\n                                        ))}\n                                    </Select>\n                                </Form.Item>\n                            </Col>\n                            <Col span={10}>\n                                <Form.Item label=\"騎乘關卡\" name=\"difficulty\">\n                                    <Select\n                                        placeholder=\"選擇關卡資訊\"\n                                        allowClear\n                                    >\n                                        {difficulties.map((diff) => (\n                                            <Option\n                                                value={diff.id}\n                                                key={diff.id}\n                                            >\n                                                {diff.name}・\n                                                {diff.targetWorkoutTime}{' '}\n                                                分鐘・目標{' '}\n                                                {diff.targetHeartRate} BPM\n                                            </Option>\n                                        ))}\n                                    </Select>\n                                </Form.Item>\n                            </Col>\n                            <Col span={4}>\n                                <Form.Item>\n                                    <Button\n                                        type=\"primary\"\n                                        htmlType=\"submit\"\n                                        onClick={onSearch}\n                                        icon={<SearchOutlined />}\n                                    >\n                                        查詢\n                                    </Button>\n                                </Form.Item>\n                            </Col>\n                        </Row>\n                    </Form>\n                    <Table\n                        columns={columns(openViewModal)}\n                        dataSource={filteredRecords}\n                        pagination={{ pageSize: 5 }}\n                        style={{ marginLeft: 24, marginRight: 24 }}\n                    />\n                    <Modal\n                        title=\"檢視紀錄\"\n                        visible={viewModalVisible}\n                        onCancel={closeViewModal}\n                        footer={null} // no [Ok], [Cancel] button\n                        width={'90vw'}\n                    >\n                        {loading ? (\n                            '資料讀取中...'\n                        ) : (\n                            <>\n                                <Descriptions\n                                    bordered\n                                    className={styles.descriptions}\n                                >\n                                    <Descriptions.Item\n                                        label=\"騎乘者姓名\"\n                                        span={2}\n                                    >\n                                        {currRecord?.userData?.name}\n                                    </Descriptions.Item>\n                                    <Descriptions.Item label=\"騎乘者身體年齡\">\n                                        {currRecord?.userData?.age}\n                                    </Descriptions.Item>\n\n                                    <Descriptions.Item\n                                        label={\n                                            <div>\n                                                實際騎乘時間\n                                                <br />/ 目標騎乘時間\n                                            </div>\n                                        }\n                                    >\n                                        {calWorkoutTime(currRecord)}／\n                                        {\n                                            currRecord?.difficultyData\n                                                ?.targetWorkoutTime\n                                        }{' '}\n                                        分\n                                    </Descriptions.Item>\n                                    <Descriptions.Item label=\"開始騎乘時間\">\n                                        {currRecord?.beginWorkoutTime.toLocaleString()}\n                                    </Descriptions.Item>\n                                    <Descriptions.Item label=\"結束騎乘時間\">\n                                        {currRecord?.finishedWorkoutTime.toLocaleString()}\n                                    </Descriptions.Item>\n                                    <Descriptions.Item label=\"騎乘關卡\">\n                                        {currRecord?.difficultyData?.name}\n                                    </Descriptions.Item>\n                                    <Descriptions.Item label=\"目標心率\">\n                                        {\n                                            currRecord?.difficultyData\n                                                ?.targetHeartRate\n                                        }\n                                    </Descriptions.Item>\n                                    <Descriptions.Item label=\"上限心率\">\n                                        {\n                                            currRecord?.difficultyData\n                                                ?.upperLimitHeartRate\n                                        }\n                                    </Descriptions.Item>\n                                    <Descriptions.Item\n                                        label=\"RPM＆心率統計圖\"\n                                        span={3}\n                                    >\n                                        <LineChart\n                                            {...configLineChart(\n                                                currReocrdPackets,\n                                                currRecord?.targetHeartRate,\n                                            )}\n                                        />\n                                    </Descriptions.Item>\n                                    <Descriptions.Item\n                                        label=\"物理治療師名稱\"\n                                        span={3}\n                                    >\n                                        {currRecord?.therapist}\n                                    </Descriptions.Item>\n                                    <Descriptions.Item\n                                        label=\"治療結果評語\"\n                                        span={3}\n                                    >\n                                        {currRecord?.comment}\n                                    </Descriptions.Item>\n                                </Descriptions>\n                            </>\n                        )}\n                    </Modal>\n                </div>\n            </Content>\n        </Layout>\n    );\n};\n\nconst columns = (openViewModal) => [\n    {\n        key: 'id',\n        title: '紀錄ID',\n        dataIndex: 'id',\n        width: 150,\n        render: (id) => `${id.slice(0, 5)}....`,\n    },\n    {\n        key: 'userData',\n        title: '騎乘者名稱',\n        dataIndex: 'userData',\n        width: 200,\n        render: (userData) => userData?.name,\n    },\n    {\n        key: 'difficulty',\n        title: '騎乘關卡',\n        dataIndex: 'difficultyData',\n        width: 200,\n        render: (difficultyData) => difficultyData?.name,\n    },\n    {\n        key: 'difficulty',\n        title: '騎乘開始時間',\n        dataIndex: 'beginWorkoutTime',\n        width: 200,\n        render: (beginWorkoutTime) => beginWorkoutTime.toLocaleString(),\n    },\n    {\n        key: 'beginWorkoutTime',\n        title: '騎乘時間',\n        width: 200,\n        render: (currRecord) => calWorkoutTime(currRecord),\n    },\n    {\n        key: 'id',\n        title: ' ',\n        dataIndex: 'id',\n        align: 'center',\n        render: (id) => (\n            <Button type=\"link\" onClick={() => openViewModal(id)}>\n                查看\n            </Button>\n        ),\n        width: 150,\n    },\n];\n\nconst calWorkoutTime = (currRecord) => {\n    if (_.isEmpty(currRecord)) {\n        return;\n    }\n    const begin = moment(currRecord?.beginWorkoutTime);\n    const end = moment(currRecord?.finishedWorkoutTime);\n\n    const diff = moment.duration(end.diff(begin)).asMilliseconds();\n\n    const h = ('0' + Math.floor(diff / 3600000)).slice(-2);\n    const m = ('0' + Math.floor((diff / 60000) % 60)).slice(-2);\n    const s = ('0' + Math.floor((diff / 1000) % 60)).slice(-2);\n\n    let returnStr = '';\n\n    if (h != '00') returnStr += `${h} 小時 `;\n    returnStr += `${m} 分 ${s} 秒`;\n\n    return returnStr;\n};\n\nconst formLayout = {\n    labelCol: {\n        // span: 8,\n        offset: 2,\n    },\n    wrapperCol: {\n        span: 16,\n    },\n};\n\nexport default RecordList;\n","import React from 'react';\nimport { Routes, Route, Navigate } from 'react-router-dom';\n\nimport { ROUTE_PATH, ROLES } from '../constants/';\n\nimport ProtectedRoutes from './ProtectedRoutes';\nimport SignIn from '../layouts/SignIn';\nimport AdminDashboard from '../layouts/AdminDashboard';\nimport Missing from '../layouts/Missing';\nimport Unauthorized from '../layouts/Unauthorized';\nimport PrepareWorkout from '../layouts/PrepareWorkout';\nimport MonitoringWorkout from '../layouts/MonitoringWorkout';\nimport UserList from '../layouts/UserList';\nimport DifficulityList from '../layouts/DifficulityList';\nimport FinishedWorkout from '../layouts/FinishedWorkout';\nimport RecordList from '../layouts/RecordList';\n\nconst AppRoutes = () => {\n    return (\n        <Routes>\n            <Route\n                path={ROUTE_PATH.home}\n                element={<Navigate replace to={ROUTE_PATH.sign_in} />}\n            />\n            <Route path={ROUTE_PATH.sign_in} element={<SignIn />} />\n            <Route path={ROUTE_PATH.unauthorized} element={<Unauthorized />} />\n\n            {/* only Admin can visit */}\n            <Route element={<ProtectedRoutes allowedRoles={[ROLES.Admin]} />}>\n                <Route\n                    path={ROUTE_PATH.admin_dashbaord}\n                    element={<AdminDashboard />}\n                />\n                <Route\n                    path={ROUTE_PATH.prepare_workout}\n                    element={<PrepareWorkout />}\n                />\n                <Route\n                    path={`${ROUTE_PATH.monitoring_workout}/:recordId`}\n                    element={<MonitoringWorkout />}\n                />\n                <Route path={ROUTE_PATH.user_list} element={<UserList />} />\n                <Route\n                    path={`${ROUTE_PATH.record_list}/:userId`}\n                    element={<RecordList />}\n                />\n                <Route\n                    path={ROUTE_PATH.difficulty_list}\n                    element={<DifficulityList />}\n                />\n                <Route\n                    path={`${ROUTE_PATH.finsished_workout}/:recordId`}\n                    element={<FinishedWorkout />}\n                />\n            </Route>\n\n            {/* catch all */}\n            <Route path=\"*\" element={<Missing />} />\n        </Routes>\n    );\n};\n\nexport default AppRoutes;\n","/* eslint-disable no-unused-vars */\n/* eslint-disable react/prop-types */\nimport { ConfigProvider } from 'antd';\nimport 'moment/locale/zh-tw';\nimport locale from 'antd/lib/locale/zh_TW';\nimport React, { useEffect, useState } from 'react';\nimport { useStore } from '../../store';\nimport { SET_AUTH } from '../../store/actions';\nimport _ from '../../util/helper';\n// import moment from 'moment';\n\n// import styles from './styles.module.scss';\nimport 'antd/dist/antd.css';\nimport '@ant-design/flowchart/dist/index.css';\n\n/*\n    expect: \n        ConfigProvider\n*/\n\nconst AppProvider = ({ children }) => {\n    const { dispatch } = useStore();\n    const [initializedDone, setInitializedDone] = useState(false);\n\n    useEffect(() => {\n        attempLogin();\n\n        window.addEventListener('beforeunload', beforeunloadListener);\n        window.addEventListener('visibilitychange', visibilitychangeListener);\n        return () => {\n            window.removeEventListener(\n                'beforeunload',\n                visibilitychangeListener,\n            );\n        };\n    }, []);\n\n    const beforeunloadListener = (e) => {\n        e.preventDefault();\n\n        dispatch({\n            type: SET_AUTH,\n            payload: {\n                isValid: false,\n                roles: [],\n            },\n        });\n    };\n\n    const visibilitychangeListener = (e) => {\n        if (document.visibilityState == 'hidden') {\n            dispatch({\n                type: SET_AUTH,\n                payload: {\n                    isValid: false,\n                    roles: [],\n                },\n            });\n        }\n    };\n\n    const attempLogin = () => {\n        // console.log('executing attemp login');\n        // const expiredIn = window.localStorage.getItem(\n        //     'inventory-system-expired-in',\n        // );\n        setInitializedDone(true);\n\n        // Example Down Below\n        // if (_.isNullOrUndefined(expiredIn)) {\n        //     setInitializedDone(true);\n        //     return;\n        // }\n        // if (moment(expiredIn).endOf('day').isSameOrAfter(moment())) {\n        //     dispatch({\n        //         type: SET_AUTH,\n        //         payload: {\n        //             isValid: true,\n        //             roles: [5051],\n        //         },\n        //     });\n        // }\n        // setInitializedDone(true);\n    };\n\n    if (!initializedDone) {\n        return null;\n    }\n\n    return <ConfigProvider locale={locale}>{children}</ConfigProvider>;\n};\n\nexport default AppProvider;\n\n// Example Down Below\n\n// /* eslint-disable react/prop-types */\n// import React from 'react';\n// import { ConfigProvider } from 'antd';\n// import 'moment/locale/zh-tw';\n// import locale from 'antd/lib/locale/zh_TW';\n\n// // import styles from './styles.module.scss';\n\n// const App = ({ children }) => (\n//     <ConfigProvider locale={locale}>{children}</ConfigProvider>\n// );\n\n// export default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport './global.scss';\n\nimport { StoreProvider } from './store';\nimport AppRoutes from './routes';\nimport AppProvider from './layouts/App';\n\nReactDOM.render(\n    <React.StrictMode>\n        <StoreProvider>\n            <BrowserRouter>\n                <AppProvider>\n                    {/* <Routes>\n                        <Route path=\"*\" element={<AppRoutes />} />\n                    </Routes> */}\n                    <AppRoutes />\n                </AppProvider>\n            </BrowserRouter>\n        </StoreProvider>\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"],"sourceRoot":""}